{"version":3,"sources":["webpack:///./src/lib/protobufExport.js","webpack:///./src/proto/place.js","webpack:///./src/components/LoadingIcon.vue?d151","webpack:///./src/components/LoadingIcon.vue","webpack:///./src/lib/Progress.js","webpack:///./src/lib/request.js","webpack:///./src/lib/postData.js","webpack:///./src/lib/BoundingBox.js","webpack:///./src/lib/Grid.js","webpack:///./src/lib/Query.js","webpack:///./src/lib/appState.js","webpack:///./src/config.js","webpack:///src/components/FindPlace.vue","webpack:///./src/components/FindPlace.vue?f532","webpack:///./src/components/FindPlace.vue","webpack:///./src/components/clickOutside.js","webpack:///src/components/EditableLabel.vue","webpack:///./src/components/EditableLabel.vue?e6d8","webpack:///./src/components/EditableLabel.vue","webpack:///src/components/ColorPicker.vue","webpack:///./src/components/ColorPicker.vue?8c27","webpack:///./src/components/ColorPicker.vue","webpack:///./src/lib/bus.js","webpack:///./src/lib/createScene.js","webpack:///./src/lib/GridLayer.js","webpack:///./src/lib/getZazzleLink.js","webpack:///src/App.vue","webpack:///./src/App.vue?47e9","webpack:///./src/App.vue","webpack:///./src/NoWebGL.vue?d991","webpack:///./src/NoWebGL.vue","webpack:///./src/main.js","webpack:///./src/lib/load.js","webpack:///../w-gl/build/wgl.module.js","webpack:///./src/lib/canvas2BlobPolyfill.js","webpack:///./src/lib/svgExport.js"],"names":["Pbf","require","place","module","exports","grid","nodes","ways","date","Date","toISOString","forEachElement","x","type","push","pbf","write","version","id","name","finish","read","end","readFields","_readField","tag","obj","readVarint","readString","node","pos","way","writeVarintField","writeStringField","i","length","writeMessage","lat","lon","readFloat","writeFloatField","readPackedVarint","writePackedVarint","LoadingIcon","render","_h","this","$createElement","_c","_self","staticClass","attrs","xmlns","viewBox","width","height","fill","opacity","d","_v","attributeName","from","to","dur","repeatCount","staticRenderFns","components_LoadingIcon","__webpack_require__","normalizeComponent","Progress","notify","classCallCheck_default","eventify","callback","Function","prototype","isCancelled","fire","progress","on","off","request","url","options","req","onCancel","cancelDownload","promise_default","a","resolve","reject","XMLHttpRequest","addEventListener","e","lengthComputable","loaded","total","percent","offCancel","status","response","responseType","JSON","parse","setTimeout","statusError","message","cancelled","open","method","headers","keys_default","forEach","key","setRequestHeader","send","body","abort","backends","BBox","minX","Infinity","minY","maxX","maxY","offset","xIn","yIn","undefined","Error","y","rect","addPoint","left","top","right","bottom","otherBBox","Grid","elements","bounds","BoundingBox","map_default","wayPointCount","isArea","projector","geoMercator","bboxString","project","getProjector","leftTop","rightBottom","Math","abs","positions","element","nodeIds","last","get","index","next","q","_ref","xyPoint","elementsOfOSMResponse","fromOSMResponse","setName","setId","gridInstance","set","center","cx","cy","scale","Query","queryString","promise","wayFilter","placeName","template","_this","parts","extendedQuery","area","match","substr","collectAllNominatimQueries","lastProcessed","processNext","part","encodeURIComponent","then","extractAreas","pickFirstArea","first","assign_default","ms","args","map","areaId","join","runAllNominmantimQueries","resolvedQueryString","data","postData","Content-type","serverIndex","fetchFrom","overpassUrl","catch","handleError","err","osmResponse","filter","row","osm_type","osm_id","display_name","areas","queryState","createQueryState","useSearch","appState","drawLabels","apply","arguments","unset","unsetPlace","config","areaServer","getDefaultLineColor","tinycolor","toRgb","getLabelColor","getBackgroundColor","hexString","color","toRgbString","FindPlace","components","enteredInput","hasValidArea","restoreStateFromQueryString","loading","lastCancel","suggestionsLoaded","stillLoading","error","hideInput","noRoads","clicked","showWarning","mainActionText","watch","mounted","$refs","input","focus","beforeDestroy","clearInterval","notifyStillLoading","methods","onSubmit","cancelRequest","restoredState","pickSuggestion","query","boundingbox","bbox","parse_float_default","getBugReportURL","title","toString","updateProgress","restartLoadingMonitor","round","formatNumber","retry","lastSuggestion","suggestion","_this2","checkCache","useOSM","_this3","setInterval","_this4","generateNewProgressToken","arrayBuffer","Uint8Array","byteArray","lib_Grid","fromPBF","$emit","_this5","serializeBBox","getQuery","lib_Query","run","hasRoads","setIsArea","setBBox","console","finally","progressToken","cancel","lib_Progress","is_finite_default","replace","parse_int_default","getCurrentAreaId","nodeAndBox","bboxStr","split","parseBBox","getCurrentNodeAndBox","components_FindPlace","_vm","class","centered","_e","submit","$event","preventDefault","directives","rawName","value","expression","ref","placeholder","domProps","target","composing","href","click","_s","_m","_l","src_components_FindPlace","FindPlace_normalizeComponent","ssrContext","nodeList","ctx","startClick","seed","createDocumentHandler","el","binding","vnode","mouseup","mousedown","context","contains","popperElm","methodName","bindingFn","document","documentHandler","clickOutside","bind","update","unbind","len","splice","EditableLabel","props","ClickOutside","looseFocus","blur","components_EditableLabel","printable","src_components_EditableLabel","EditableLabel_normalizeComponent","ColorPicker","sketch-picker","vue_color_min","Object","showPicker","colors","hex","colorValue","panelLeft","panelTop","computed","pickerType","isTransparent","btnStyle","background","backgroundImage","backgroundPosition","backgroundSize","_colorValue","r","g","b","val","oldVal","updateColorObject","newVal","triggerRect","triggerButton","getBoundingClientRect","desiredLeft","desiredTop","window","innerHeight","max","innerWidth","hide","changeColor","rgba","colorObj","tinycolor_default","toHexString","hsl","toHsl","hsv","toHsv","getAlpha","h","s","l","v","components_ColorPicker","style","model","$$v","src_components_ColorPicker","ColorPicker_normalizeComponent","bus","Vue","wgl","createScene","canvas","scene","setClearColor","slowDownZoom","layers","onKeyDown","onKeyUp","renderFrame","clear","layer","destroy","getLayers","dispose","removeEventListener","setLineColor","setBackground","add","gridLayer","indexOf","bindToScene","getViewBox","setViewBox","getProjectedVisibleRect","getSceneCoordinate","bottomRight","shiftKey","getPanzoom","setZoomSpeed","counter","GridLayer","_color","lines","dx","dy","unsafeColor","toRatioColor","_grid$getProjectedRec","getProjectedRect","initialSceneSize","_transferTransform","WireCollection","forEachWay","removeChild","getLinesCollection","appendChild","transform","updateWorldTransform","c","imageUrl","productKinds","mug","generateZazzleLink","imageContent","toDataURL","form","FormData","append","success","kind","productCode","getZazzleLink","link","log","lastGrid","App","placeFound","zazzleLink","generatingPreview","showPrintWindow","settingsOpen","lineColor","labelColor","backgroundColor","labelColorRGBA","toRGBA","created","$on","handleSceneTransform","$off","togglePrintWindow","onGridLoaded","getCanvas","visibility","lib_GridLayer","setGrid","startOver","toPNGFile","printableCanvas","getPrintableCanvas","fileName","getFileName","toBlob","blob","URL","createObjectURL","createElement","download","revokeObjectURL","toSVGFile","visibleRect","svg","svgExport_default","stroke","toHex","labels","collectText","Blob","extension","toProtobuf","protobufExport_default","buffer","updateLinesColor","updateBackground","setBackgroundColor","zazzleMugPrint","recordOpenClick","cityCanvas","getContext","drawImage","label","save","dpr","devicePixelRatio","font","fontSize","fontFamily","fillStyle","textAlign","fillText","text","restore","drawHtml","from_default","querySelectorAll","computedStyle","getComputedStyle","innerText","querySelector","hexValue","ga","eventCategory","eventAction","eventLabel","selectortype_template_index_0_src_App","change","src_App","App_normalizeComponent","NoWebGL","src","alt","src_NoWebGL","NoWebGL_normalizeComponent","exDescription","filename","lineno","exFatal","productionTip","load","queryFilter","all","isWebGLEnabled","defineProperty","__webpack_exports__","global","makeScene$1","PointCollection","Point","LineCollection","LineStripCollection","Element","isWebGLEnabled$1","glUtils","wheel","addWheelListener","addWheelListener_1","removeWheelListener_1","listener","useCapture","removeWheelListener","NEWTON_ITERATIONS","NEWTON_MIN_SLOPE","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","kSplineTableSize","kSampleStepSize","float32ArraySupported","Float32Array","A","aA1","aA2","B","C","calcBezier","aT","getSlope","LinearEasing","mX1","mY1","mX2","mY2","sampleValues","Array","getTForX","aX","intervalStart","currentSample","lastSample","guessForT","initialSlope","aGuessT","currentSlope","newtonRaphsonIterate","aA","aB","currentX","currentT","binarySubdivide","animations","ease","easeIn","easeOut","easeInOut","linear","amator","source","start","create","diff","easing","warn","step","noop$1","done","scheduler","canRaf","requestAnimationFrame","cancelAnimationFrame","cb","clearTimeout","getScheduler","keys","previousAnimationId","durationInMs","duration","durationInFrames","frame","loop","t","setValues","makeAggregateRaf_1","makeAggregateRaf","sharedScheduler","frontBuffer","Set","backBuffer","frameToken","clearAll","ngraph_events$1","subject","reservedWords","hasOwnProperty","validateSubject","eventsStorage","registeredEvents","eventName","handlers","wantToRemoveAll","deleteAllCallbacksForEvent","callbacks","fireArguments","call","callbackInfo","createEventsStorage","commonjsGlobal","self","kinetic_1","getPoint","scroll","settings","lastPoint","timestamp","ticker","vx","targetX","ax","vy","targetY","ay","raf","minVelocity","amplitude","getCancelAnimationFrame","handler","getRequestAnimationFrame","timeConstant","track","stop","currentPoint","now","autoScroll","elapsed","dt","moving","exp","createTextSelectionInterceptor_1","useFake","capture","noop$2","release","dragObject","prevSelectStart","prevDragStart","wasCaptured","domObject","onselectstart","ondragstart","disabled","stopPropagation","svgController","svgElement","SVGElement","owner","ownerSVGElement","disableKeyboardInteraction","setAttribute","getBBox","getScreenCTM","ctm","getCTM","getOwner","applyTransform","initTransform","screenCTM","f","removeAttributeNS","domController","domElement","HTMLElement","parentElement","scrollTop","clientWidth","clientHeight","transformOrigin","domTextSelectionInterceptor","fakeTextSelectorInterceptor","defaultZoomSpeed","defaultDoubleTapZoomSpeed","doubleTapSpeedInMS","panzoom","createPanZoom","panController","controller","storedCTMResult","isDirty","transform$$1","frameAnimation","filterKey","noop","pinchSpeed","maxZoom","Number","POSITIVE_INFINITY","minZoom","boundsPadding","zoomDoubleClickSpeed","beforeWheel","beforeMouseDown","speed","zoomSpeed","parseTransformOrigin","textSelection","enableTextSelection","boundsType","isNumber","validateBounds","autocenter","w","sceneBoundingBox","getBoundingBox","ownerRect","dh","dw","min","mouseX","mouseY","pinchZoomLength","smoothScroll","moveByAnimation","zoomToAnimation","multiTouch","lastTouchEndTime","touchInProgress","panstartFired","cancelZoomAnimation","moveTo","paused","listenForEvents","api","releaseEvents","moveBy","internalMoveBy","centerOn","ui","parent","clientRect","container","zoomTo","publicZoomTo","zoomAbs","smoothZoom","smoothZoomAbs","clientX","clientY","toScaleValue","showRectangle","size","transformToScreen","rectWidth","rectHeight","isFinite","pause","resume","isPaused","getTransform","getMinZoom","getMaxZoom","getTransformOrigin","setTransformOrigin","newTransformOrigin","getZoomSpeed","newSpeed","parentCTM","parentScaleX","parentScaleY","parentOffsetX","parentOffsetY","keepTransformInsideBounds","triggerEvent","makeDirty","boundingBox","adjusted","sceneWidth","sceneHeight","zoomByRatio","ratio","isNaN","newScale","zoomLevel","smooth","lastX","lastY","onMouseDown","passive","onDoubleClick","onTouch","onMouseWheel","releaseDocumentMouse","releaseTouches","triggerPanEnd","z","keyCode","scaleMultiplier","getScaleMultiplier","getTransformOriginOffset","beforeTouch","touches","getOffsetXY","startTouchListenerIfNeeded","handleSingleFingerTouch","getPinchZoomLength","handleTouchMove","handleTouchEnd","point","triggerPanStart","t1","t2","currentPinchLength","firstTouchPoint","secondTouchPoint","finger1","finger2","sqrt","beforeDoubleClick","button","event","onMouseMove","onMouseUp","srcElement","delta","deltaY","deltaMode","fromValue","triggerZoomEnd","sign","failTransformOrigin","scripts","getElementsByTagName","panzoomScript","getAttribute","globalName","started","tryAttach","script","attributes","attr","nameValue","getPanzoomAttributeNameValue","collectOptions","autoRun","ngraph_events$3","validateSubject$1","createEventsStorage$1","Transform$2","_array","prototypeAccessors","multiply","newDx","newDy","copyTo","dst","copyArray","getArray","defineProperties","children","worldTransform","worldTransformNeedsUpdate","child","sendToBack","unshift","bindScene","traverse","enterCallback","exitCallback","childIdx","force","wasDirty","draw","gl","screen","maxSingleTouchTime","singleTapDistanceSquared","drawContext","pixelRatio","wglContextOptions","wglContext","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","enable","BLEND","clearColor","COLOR_BUFFER_BIT","sceneRoot","updateCanvasSize","getClientCoordinate","sceneX","sceneY","getRoot","panzoom$$1","newT","wglController","onTransform","disposeClick","onResize","getPixelRatio","setPixelRatio","newPixelRatio","offsetWidth","offsetHeight","wglPanZoom","outline","startPos","touchStartTime","invokeHandler","handleTouchStart","pageX","pageY","touch","changedTouches","onClap$1","onMouseClick","listenToEvents","viewport","p","originalEvent","canvasY","immediate","compile","shaderSrc","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexShader","fragmentShader","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","getLocations","getAttributes","uniforms","getUniforms","initBuffer","elementsPerVertex","attribute","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","enableVertexAttribArray","numberOfAttributes","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","numberOfUniforms","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","shaderGraph","getVSCode","code","globals","mainBody","panzoomVS","vertexShaderSrc","fragmentShaderSrc","vertexProgramCache","Map","makePointsProgram$1","vertexProgram","VERTEX_SHADER","FRAGMENT_SHADER","locations","byteLength","DYNAMIC_DRAW","pointTexture","createTexture","bindTexture","TEXTURE_2D","image","result","col","rgbaCoord","distToCenter","sample","circle","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","generateMipmap","createCircleTexture","count","useProgram","bpe","BYTES_PER_ELEMENT","uniformMatrix4fv","uTransform","uniform2f","uScreenSize","aPosition","aPointSize","aColor","drawArrays","POINTS","updateData","newData","deleteProgram","deleteTexture","delete","depth","avg","Color","PointAccessor","prototypeAccessors$1","defaults","points","setColor","ITEMS_PER_POINT","Element$$1","capacity","pointsAccessor","pointsBuffer","_program","__proto__","constructor","_extendArray","internalNodeId","pointAccessor","BaseLineCollection","itemsPerLine","_makeProgram","_addInternal","line","newCapacity","extendedArray","lineVSSrc","lineFSSrc","lineProgramCache","makeLineProgram$1","drawTriangles","lineProgram","lineVSShader","lineFSShader","lineBuffer","drawType","TRIANGLES","LINES","bufferSubData","uniform4f","uColor","deleteBuffer","LineAccessor","setWidth","norm","u","uw","vw","x0","y0","x1","y1","x2","y2","x3","y3","BaseLineCollection$$1","lineUI","WireAccessor","lineProgramCache$1","makeLineProgram$2","allowColors","itemsPerVertex","getShadersCode","startFrom","madeFullCircle","transformArray","elementsCount","LINE_STRIP","drawCount","nextElementIndex","ArrayBuffer","Uint32Array","WebGLRenderingContext","CanvasPrototype","HTMLCanvasElement","hasBlobConstructor","Boolean","hasArrayBufferViewSupport","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","dataURIPattern","dataURLtoBlob","atob","dataURI","matches","mediaType","isBase64","dataString","byteString","intArray","bb","slice","decodeURIComponent","charCodeAt","getBlob","mozGetAsFile","quality","define","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default","strokeWidth","svgDoc","prev","hasLine","pt","isOutside","prefix","shouldAddPrefix","addPaths","insecurelyEscaped","leftOffset","bottomOffset","upScale","item","addText"],"mappings":"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","file":"static/js/app.80921318ee778aaed5ff.js","sourcesContent":["var Pbf = require('pbf');\nvar place = require('../proto/place.js').place;\n\nmodule.exports = function protoBufExport(grid) {\n  let nodes = [];\n  let ways = [];\n  let date = (new Date()).toISOString();\n\n  grid.forEachElement(x => {\n    let elementType = 0;\n    if (x.type === 'node') {\n      nodes.push(x)\n    } else if (x.type === 'way') {\n      ways.push(x)\n    }\n  });\n\n  let pbf = new Pbf()\n  place.write({\n    version: 1,\n    id: grid.id,\n    date, \n    name: grid.name,\n    nodes, ways\n  }, pbf);\n  return pbf.finish();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/protobufExport.js","'use strict'; // code generated by pbf v3.2.1\n\n// place ========================================\n\nvar place = exports.place = {};\n\nplace.read = function (pbf, end) {\n    return pbf.readFields(place._readField, {version: 0, name: \"\", date: \"\", id: \"\", nodes: [], ways: []}, end);\n};\nplace._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.version = pbf.readVarint();\n    else if (tag === 2) obj.name = pbf.readString();\n    else if (tag === 3) obj.date = pbf.readString();\n    else if (tag === 4) obj.id = pbf.readString();\n    else if (tag === 5) obj.nodes.push(place.node.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 6) obj.ways.push(place.way.read(pbf, pbf.readVarint() + pbf.pos));\n};\nplace.write = function (obj, pbf) {\n    if (obj.version) pbf.writeVarintField(1, obj.version);\n    if (obj.name) pbf.writeStringField(2, obj.name);\n    if (obj.date) pbf.writeStringField(3, obj.date);\n    if (obj.id) pbf.writeStringField(4, obj.id);\n    if (obj.nodes) for (var i = 0; i < obj.nodes.length; i++) pbf.writeMessage(5, place.node.write, obj.nodes[i]);\n    if (obj.ways) for (i = 0; i < obj.ways.length; i++) pbf.writeMessage(6, place.way.write, obj.ways[i]);\n};\n\n// place.node ========================================\n\nplace.node = {};\n\nplace.node.read = function (pbf, end) {\n    return pbf.readFields(place.node._readField, {id: 0, lat: 0, lon: 0}, end);\n};\nplace.node._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.id = pbf.readVarint();\n    else if (tag === 2) obj.lat = pbf.readFloat();\n    else if (tag === 3) obj.lon = pbf.readFloat();\n};\nplace.node.write = function (obj, pbf) {\n    if (obj.id) pbf.writeVarintField(1, obj.id);\n    if (obj.lat) pbf.writeFloatField(2, obj.lat);\n    if (obj.lon) pbf.writeFloatField(3, obj.lon);\n};\n\n// place.way ========================================\n\nplace.way = {};\n\nplace.way.read = function (pbf, end) {\n    return pbf.readFields(place.way._readField, {nodes: []}, end);\n};\nplace.way._readField = function (tag, obj, pbf) {\n    if (tag === 1) pbf.readPackedVarint(obj.nodes);\n};\nplace.way.write = function (obj, pbf) {\n    if (obj.nodes) pbf.writePackedVarint(1, obj.nodes);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/proto/place.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{staticClass:\"loader\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 32 32\",\"width\":\"12\",\"height\":\"12\",\"fill\":\"black\"}},[_c('path',{attrs:{\"opacity\":\".25\",\"d\":\"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\"}}),_vm._v(\" \"),_c('path',{attrs:{\"d\":\"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\"}},[_c('animateTransform',{attrs:{\"attributeName\":\"transform\",\"type\":\"rotate\",\"from\":\"0 16 16\",\"to\":\"360 16 16\",\"dur\":\"0.8s\",\"repeatCount\":\"indefinite\"}})],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5e3ceff5\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/LoadingIcon.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nvar __vue_script__ = null\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5e3ceff5\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./LoadingIcon.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/LoadingIcon.vue\n// module id = null\n// module chunks = ","import eventify from 'ngraph.events';\n\nexport default class Progress {\n  constructor(notify) {\n    eventify(this)\n    this.callback = notify || Function.prototype;\n  }\n\n  cancel() {\n    this.isCancelled = true;\n    this.fire('cancel');\n  }\n\n  notify(progress) {\n    if (!this.isCancelled) {\n      this.callback(progress);\n    }\n  }\n\n  onCancel(callback) {\n    this.on('cancel', callback, this);\n  }\n\n  offCancel(callback) {\n    this.off('cancel', callback);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/Progress.js","import Progress from './Progress';\n\nexport default function request(url, options) {\n  if (!options) options = {};\n  let req;\n  let progress = options.progress || new Progress();\n  let isCancelled = false;\n  if (progress.on) {\n    progress.onCancel(cancelDownload);\n  }\n\n  return new Promise(download);\n\n  function cancelDownload() {\n    isCancelled = true;\n    if (req) {\n      req.abort();\n    }\n  }\n\n  function download(resolve, reject) {\n    req = new XMLHttpRequest();\n\n    if (typeof progress.notify === 'function') {\n      req.addEventListener('progress', updateProgress, false);\n    }\n\n    req.addEventListener('load', transferComplete, false);\n    req.addEventListener('error', transferFailed, false);\n    req.addEventListener('abort', transferCanceled, false);\n\n    req.open(options.method || 'GET', url);\n    if (options.responseType) {\n      req.responseType = options.responseType;\n    }\n\n    if (options.headers) {\n      Object.keys(options.headers).forEach(key => {\n        req.setRequestHeader(key, options.headers[key]);\n      });\n    }\n\n    if (options.method === 'POST') {\n      req.send(options.body);\n    } else {\n      req.send(null);\n    }\n\n    function updateProgress(e) {\n      if (e.lengthComputable) {\n        progress.notify({\n          loaded: e.loaded,\n          total: e.total,\n          percent: e.loaded / e.total,\n          lengthComputable: true\n        });\n      } else {\n        progress.notify({\n          loaded: e.loaded,\n          lengthComputable: false\n        });\n      }\n    }\n\n    function transferComplete() {\n      progress.offCancel(cancelDownload);\n\n      if (progress.isCancelled) return;\n\n      if (req.status !== 200) {\n        reject({\n          statusError: req.status,\n          message: `Unexpected status code ${req.status} when calling ${url}`\n        });\n        return;\n      }\n      var response = req.response;\n\n      if (options.responseType === 'json' && typeof response === 'string') {\n        // IE\n        response = JSON.parse(response);\n      }\n\n      setTimeout(() => resolve(response), 0);\n    }\n\n    function transferFailed() {\n      reject(`Failed to download ${url}`);\n    }\n\n    function transferCanceled() {\n      reject({\n        cancelled: true,\n        message: `Cancelled download of ${url}`\n      });\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/request.js","import request from './request';\nimport Progress from './Progress';\n\nlet backends = [\n  'https://overpass.kumi.systems/api/interpreter',\n  'https://overpass-api.de/api/interpreter',\n  'https://overpass.openstreetmap.ru/cgi/interpreter'\n]\n\nexport default function postData(data, progress) {\n  progress = progress || new Progress();\n  const postData = {\n    method: 'POST',\n    responseType: 'json',\n    progress,\n    headers: {\n      'Content-type': 'application/x-www-form-urlencoded; charset=UTF-8'\n    },\n    body: 'data=' + encodeURIComponent(data),\n  };\n\n  let serverIndex = 0;\n\n  return fetchFrom(backends[serverIndex]);\n\n  function fetchFrom(overpassUrl) {\n    return request(overpassUrl, postData, 'POST')\n      .catch(handleError);\n  }\n\n  function handleError(err) {\n    if (err.cancelled) throw err;\n\n    if (serverIndex >= backends.length - 1) {\n      // we can't do much anymore\n      throw err;\n    } \n\n    if (err.statusError) {\n      progress.notify({\n        loaded: -1\n      });\n    }\n\n    serverIndex += 1;\n    return fetchFrom(backends[serverIndex])\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/postData.js","export default class BBox {\n  constructor() {\n    this.minX = Infinity;\n    this.minY = Infinity;\n    this.maxX = -Infinity;\n    this.maxY = -Infinity;\n  }\n\n  growBy(offset) {\n    this.minX -= offset;\n    this.minY -= offset;\n    this.maxX += offset;\n    this.maxY += offset;\n  }\n\n  get left() {\n    return this.minX;\n  }\n\n  get top() {\n    return this.minY;\n  }\n\n  get right() {\n    return this.maxX;\n  }\n\n  get bottom() {\n    return this.maxY;\n  }\n\n  get width() {\n    return this.maxX - this.minX;\n  }\n\n  get height() {\n    return this.maxY - this.minY;\n  }\n\n  get cx() {\n    return (this.minX + this.maxX)/2;\n  }\n\n  get cy() {\n    return (this.minY + this.maxY)/2;\n  }\n\n  addPoint(xIn, yIn) {\n    if (xIn === undefined) throw new Error('Point is not defined');\n    let x = xIn;\n    let y = yIn;\n    if (y === undefined) {\n      // xIn is a point object\n      x = xIn.x;\n      y = xIn.y;\n    }\n\n    if (x < this.minX) this.minX = x;\n    if (x > this.maxX) this.maxX = x;\n    if (y < this.minY) this.minY = y;\n    if (y > this.maxY) this.maxY = y;\n  }\n\n  addRect(rect) {\n    if (!rect) throw new Error('rect is not defined');\n    this.addPoint(rect.left, rect.top);\n    this.addPoint(rect.right, rect.top);\n    this.addPoint(rect.left, rect.bottom);\n    this.addPoint(rect.right, rect.bottom);\n  }\n\n  merge(otherBBox) {\n    if (otherBBox.minX < this.minX) this.minX = otherBBox.minX;\n    if (otherBBox.minY < this.minY) this.minY = otherBBox.minY;\n    if (otherBBox.maxX > this.maxX) this.maxX = otherBBox.maxX;\n    if (otherBBox.maxY > this.maxY) this.maxY = otherBBox.maxY;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/BoundingBox.js","import BoundingBox from './BoundingBox';\nimport {geoMercator} from 'd3-geo';\n\n/**\n * All roads in the area\n */\nexport default class Grid {\n  constructor() {\n    this.elements = [];\n    this.bounds = new BoundingBox();\n    this.nodes = new Map();\n    this.wayPointCount = 0;\n    this.id = 0;\n    this.name = '';\n    this.isArea = true;\n    this.projector = geoMercator();\n  }\n\n  setName(name) {\n    this.name = name;\n  }\n\n  setId(id) {\n    this.id = id;\n  }\n\n  setIsArea(isArea) {\n    this.isArea = isArea;\n  }\n\n  setBBox(bboxString) {\n    this.bboxString = bboxString;\n  }\n\n  hasRoads() {\n    return this.wayPointCount > 0;\n  }\n\n  static fromPBF(pbf) {\n    if (pbf.version !== 1) throw new Error('Unknown version ' + pbf.version);\n    let elementsOfOSMResponse = [];\n    pbf.nodes.forEach(node => {\n      node.type = 'node';\n      elementsOfOSMResponse.push(node)\n    });\n    pbf.ways.forEach(way => {\n      way.type = 'way';\n      elementsOfOSMResponse.push(way);\n    });\n\n    const grid = Grid.fromOSMResponse(elementsOfOSMResponse);\n    grid.setName(pbf.name);\n    grid.setId(pbf.id);\n    return grid;\n  }\n\n  static fromOSMResponse(elementsOfOSMResponse) {\n    let gridInstance = new Grid();\n\n    let nodes = gridInstance.nodes;\n    let bounds = gridInstance.bounds;\n    let wayPointCount = 0;\n\n    // TODO: async?\n    elementsOfOSMResponse.forEach(element => {\n      if (element.type === 'node') {\n        nodes.set(element.id, element);\n        bounds.addPoint(element.lon, element.lat);\n      } else if (element.type === 'way') {\n        wayPointCount += element.nodes.length;\n      }\n    });\n\n    gridInstance.elements = elementsOfOSMResponse;\n    gridInstance.projector\n      .center([bounds.cx, bounds.cy])\n      .scale(6371393); // Radius of Earth\n\n    gridInstance.wayPointCount = wayPointCount;\n    return gridInstance;\n  }\n\n  getProjectedRect() {\n    let bounds = this.bounds;\n    let project = this.getProjector();\n    let leftTop = project({lon: bounds.left, lat: bounds.bottom});\n    let rightBottom = project({lon: bounds.right, lat: bounds.top});\n    let left = leftTop.x;\n    let top = leftTop.y;\n    let bottom = rightBottom.y\n    let right = rightBottom.x;\n    return {\n      left, top, right, bottom,\n      width: right - left, height: Math.abs(bottom - top)\n    }\n  }\n\n  forEachElement(callback) {\n    this.elements.forEach(callback);\n  }\n\n  forEachWay(callback) {\n    let positions = this.nodes;\n    let project = this.getProjector();\n    this.elements.forEach(element => {\n      if (element.type !== 'way') return;\n\n      let nodeIds = element.nodes;\n      let last = project(positions.get(nodeIds[0]));\n\n      for (let index = 1; index < nodeIds.length; ++index) {\n        let next = project(positions.get(nodeIds[index]));\n\n        callback(last, next);\n\n        last = next;\n      }\n    });\n  }\n\n  getProjector() {\n    let q = [0, 0]; // reuse to avoid GC.\n    let projector = this.projector;\n\n    return project;\n\n    function project({lon, lat}) {\n      q[0] = lon; q[1] = lat;\n\n      let xyPoint = projector(q);\n\n      return {\n        x: xyPoint[0],\n        y: xyPoint[1]\n      };\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/Grid.js","import postData from './postData';\nimport Grid from './Grid';\nimport request from './request';\n\nexport default class Query {\n\n  static all(wayFilter, placeName) {\n    let template = `[timeout:9000][maxsize:2000000000][out:json];\narea({{geocodeArea:${placeName}}});\n(._; )->.area;\n(${wayFilter}(area.area); node(w););\nout skel;`;\n    return new Query(template);\n  }\n\n  constructor(queryString, progress) {\n    this.queryString = queryString;\n    this.progress = progress;\n    this.promise = null;\n  }\n\n  run() {\n    if (this.promise) {\n      return this.promise;\n    }\n    let parts = collectAllNominatimQueries(this.queryString);\n    this.promise = runAllNominmantimQueries(parts)\n      .then(resolvedQueryString => postData(resolvedQueryString, this.progress))\n      .then(osmResponse => {\n        let grid = Grid.fromOSMResponse(osmResponse.elements)\n        return grid;\n      });\n\n    return this.promise;\n  }\n}\n\nfunction runAllNominmantimQueries(parts) {\n  let lastProcessed = 0;\n\n  return processNext().then(concat);\n\n  function concat() {\n    return parts.map(part => typeof part === 'string' ? part : part.areaId).join('');\n  }\n  \n  function processNext() {\n    if (lastProcessed >= parts.length) {\n      return Promise.resolve();\n    }\n    \n    let part = parts[lastProcessed];\n    lastProcessed += 1;\n    if (typeof part === 'string') return processNext();\n\n    if (part.type === 'area') {\n      let name = encodeURIComponent(part.name);\n      return request(`https://nominatim.openstreetmap.org/search?format=json&q=${name}`, {responseType: 'json'})\n        .then(extractAreas)\n        .then(pickFirstArea)\n        .then(first => {\n          if (!first) {\n            throw new Error('No areas found for request ' + part.name);\n          }\n          Object.assign(part, first);\n        })\n        .then(wait(1000)) // per nominatim agreement we are not allowed to issue more tan 1 request per second\n        .then(processNext);\n    }\n\n    throw new Error('Unknown part: ' + part);\n  }\n}\n\nfunction extractAreas(x) {\n  let areas = x.filter(row => row.osm_type === 'relation' || row.osm_type === 'way')\n    .map(row => {\n      // TODO: this duplicates FindPlace code. Refactor.\n      let areaId;\n      if (row.osm_type === 'relation') {\n        areaId = row.osm_id + 36e8;\n      } else if (row.osm_type === 'way') {\n        areaId = row.osm_id + 24e8;\n      }\n\n      return {\n        areaId,\n        name: row.display_name,\n        type: row.type,\n      };\n    });\n\n  return areas;\n}\n\nfunction pickFirstArea(areas) {\n  if (areas.length > 0) {\n    return areas[0];\n  }\n}\n\nfunction collectAllNominatimQueries(extendedQuery) {\n  let area = /{{geocodeArea:(.+?)}}/;\n  let match;\n  let parts = [];\n  let lastIndex = 0;\n  while ((match = extendedQuery.match(area))) {\n    parts.push(extendedQuery.substr(0, match.index));\n    parts.push({\n      type: 'area',\n      name: match[1]\n    });\n    extendedQuery = extendedQuery.substr(match.index + match[0].length)\n  }\n\n  parts.push(extendedQuery);\n\n  return parts;\n}\n\nfunction wait(ms) {\n  return function(args) {\n    return new Promise(resolve => {\n      setTimeout(() => resolve(args), ms);\n    });\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/Query.js","import createQueryState from 'query-state';\n\nconst queryState = createQueryState({}, {useSearch: true});\n\n/**\n * This is our base state. It just persists default information about\n * custom settings and integrates with query string.\n */\nexport default {\n  drawLabels: true,\n  get() {\n    return queryState.get.apply(queryState, arguments);\n  },\n  set() {\n    return queryState.set.apply(queryState, arguments);\n  },\n  unset() {\n    return queryState.unset.apply(queryState, arguments);\n  },\n\n  unsetPlace() {\n    queryState.unset('areaId');\n    queryState.unset('osm_id');\n    queryState.unset('bbox');\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/appState.js","import tinycolor from 'tinycolor2';\n\nexport default {\n  /**\n   * This is our caching backend\n   */\n  areaServer: 'https://anvaka.github.io/index-large-cities/data',\n  // areaServer: 'http://localhost:8085/', // This is un-commented when I develop cache locally\n\n  getDefaultLineColor() {\n    return tinycolor('rgba(26, 26, 26, 0.8)').toRgb();\n  },\n  getLabelColor() {\n    return tinycolor('#161616').toRgb();\n  },\n  getBackgroundColor(hexString) {\n    let color = tinycolor('#F7F2E8');\n    return hexString ? color.toRgbString() : color.toRgb();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","<template>\n<div class='find-place' :class='{centered: !suggestionsLoaded }'>\n  <div v-if='!suggestionsLoaded'>\n    <h3 class='site-header'>city roads</h3>\n    <p class='description'>This website renders every single road within a city</p>\n  </div>\n  <form v-on:submit.prevent=\"onSubmit\" class='search-box'>\n      <input class='query-input' v-model='enteredInput' type='text' placeholder='Enter a city name to start' ref='input'>\n      <a type='submit' class='search-submit' href='#' @click.prevent='onSubmit' v-if='enteredInput && !hideInput'>{{mainActionText}}</a>\n  </form>\n  <div v-if='showWarning' class='prompt message note shadow'>\n    Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render.\n  </div>\n  <div class='results' v-if='!loading'>\n    <div v-if='suggestionsLoaded && data.length' class='suggestions shadow'>\n      <div class='prompt message'>\n        <div>Select boundaries below to download all roads within</div>\n        <div class='note'>large cities may require 200MB+ of data transfer and a powerful device</div>\n      </div>\n      <ul>\n        <li v-for='(suggestion, index) in data' :key=\"index\">\n          <a @click.prevent='pickSuggestion(suggestion)' class='suggestion'\n          href='#'>\n          <span>\n          {{suggestion.name}} <small>({{suggestion.type}})</small>\n          </span>\n          </a>\n        </li>\n      </ul>\n    </div>\n    <div v-if='suggestionsLoaded && !data.length && !loading && !error' class='no-results message shadow'>\n      Didn't find matching cities. Try a different query?\n    </div>\n    <div v-if='noRoads' class='no-results message shadow'>\n      Didn't find any roads. Try a different query?\n    </div>\n  </div>\n  <div v-if='error' class='error message shadow'>\n    <div>Sorry, we were not able to download data from the OpenStreetMap.\n    It could be very busy at the moment processing other requests. <br/><br/> Please bookmark this website and <a href='#' @click.prevent=\"retry\">try again</a> later?</div>\n    <div class='error-links'>\n      <a href='https://twitter.com/anvaka/status/1218971717734789120' title='see what it supposed to do' target=\"_blank\">see how it should have worked</a>\n      <a :href='getBugReportURL(error)' :title='\"report error: \" + error' target='_blank'>report this bug</a>\n    </div>\n  </div>\n  <div v-if='loading' class='loading message shadow'>\n    <loading-icon></loading-icon>\n    <span>{{loading}}</span>\n    <a href=\"#\" @click.prevent='cancelRequest' class='cancel-request'>cancel</a>\n    <div class='load-padding' v-if='stillLoading > 0'>\n      Still loading...\n    </div>\n    <div class='load-padding' v-if='stillLoading > 1'>\n      Sorry it takes so long!\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport LoadingIcon from './LoadingIcon';\nimport Query from '../lib/Query';\nimport request from '../lib/request';\nimport appState from '../lib/appState';\nimport Grid from '../lib/Grid';\nimport queryState from '../lib/appState';\nimport config from '../config';\nimport Progress from '../lib/Progress'\n\nconst FIND_TEXT = 'Find City Bounds';\n\nexport default {\n  name: 'FindPlace',\n  components: {\n    LoadingIcon\n  },\n  data () {\n    const enteredInput = appState.get('q') || '';\n    let hasValidArea = restoreStateFromQueryString();\n\n    return {\n      enteredInput,\n      loading: null,\n      lastCancel: null,\n      suggestionsLoaded: false,\n      stillLoading: 0,\n      error: null,\n      hideInput: false,\n      noRoads: false,\n      clicked: false,\n      showWarning: hasValidArea, \n      mainActionText: hasValidArea ? 'Download Area' : FIND_TEXT,\n      data: []\n    }\n  },\n  watch: {\n    enteredInput() {\n      // As soon as they change it, we need not to download:\n      this.mainActionText = FIND_TEXT;\n      this.showWarning = false;\n      this.hideInput = false;\n      appState.unsetPlace();\n    }\n  },\n  mounted() {\n    this.$refs.input.focus();\n  },\n  beforeDestroy() {\n    if (this.lastCancel) this.lastCancel();\n    clearInterval(this.notifyStillLoading);\n  },\n  methods: {\n    onSubmit() {\n      queryState.set('q', this.enteredInput);\n      this.cancelRequest()\n      this.data = [];\n      this.noRoads = false;\n      this.error = false;\n      this.showWarning = false;\n\n      const restoredState = restoreStateFromQueryString(this.enteredInput);\n      if (restoredState) {\n        this.pickSuggestion(restoredState);\n        return;\n      }\n\n      const query = encodeURIComponent(this.enteredInput);\n      this.loading = 'Searching cities that match your query...'\n      request(`https://nominatim.openstreetmap.org/search?format=json&q=${query}`, {responseType: 'json'})\n        .then(x => x.map(row => {\n          if (row.osm_type === 'relation') {\n            return {\n              name: row.display_name,\n              type: row.type,\n              // By convention the area id can be calculated from an existing \n              // OSM way by adding 2400000000 to its OSM id, or in case of a \n              // relation by adding 3600000000 respectively. So we are adding this\n              // https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL#By_area_.28area.29\n              // Note: we may want to do another case for osm_type = 'way'. Need to check\n              // if it returns correct values.\n              areaId: row.osm_id + 36e8\n            };\n          } else if (row.boundingbox) {\n            return {\n              name: row.display_name,\n              type: row.type,\n              osm_id: row.osm_id,\n              bbox: [\n                Number.parseFloat(row.boundingbox[0]),\n                Number.parseFloat(row.boundingbox[2]),\n                Number.parseFloat(row.boundingbox[1]),\n                Number.parseFloat(row.boundingbox[3]),\n              ]\n            };\n          }\n        }).filter(x => x)\n        ).then(data => {\n          this.loading = null;\n          this.suggestionsLoaded = true;\n          this.data = data; // TODO: Rename this to something less generic\n          this.hideInput = data && data.length;\n        });\n    },\n\n    getBugReportURL(error) {\n      let title = encodeURIComponent('OSM Error');\n      let body = '';\n      if (error) {\n        body = 'Hello, an error occurred on the website:\\n\\n```\\n' +\n          error.toString() + '\\n```\\n\\n Can you please help?';\n      }\n\n      return `https://github.com/anvaka/city-roads/issues/new?title=${title}&body=${encodeURIComponent(body)}`\n    },\n\n    updateProgress(status) {\n      this.stillLoading = 0;\n      clearInterval(this.notifyStillLoading);\n      if (status.loaded < 0) {\n        this.loading = 'Trying a different server'\n        this.restartLoadingMonitor();\n        return;\n      }\n      if (status.percent !== undefined) {\n        this.loading = 'Loaded ' + Math.round(100 * status.percent) + '% (' + formatNumber(status.loaded) + ' bytes)...';\n      } else {\n        this.loading = 'Loaded ' + formatNumber(status.loaded) + ' bytes...';\n      }\n    },\n\n    retry() {\n      if (this.lastSuggestion) {\n        this.pickSuggestion(this.lastSuggestion);\n      }\n    },\n\n    pickSuggestion(suggestion) {\n      this.lastSuggestion = suggestion;\n      this.error = false;\n      if (suggestion.areaId) {\n        this.checkCache(suggestion)\n          .catch(error => {\n            if (error.cancelled) return; // no need to do anything. They've cancelled\n\n            // No Cache - fallback\n            return this.useOSM(suggestion);\n          });\n      } else {\n        // we don't have cache for nodes yet.\n        this.useOSM(suggestion);\n      }\n    },\n\n    restartLoadingMonitor() {\n      clearInterval(this.notifyStillLoading);\n      this.stillLoading = 0;\n      this.notifyStillLoading = setInterval(() => {\n        this.stillLoading++;\n      }, 10000);\n    },\n\n    checkCache(suggestion) {\n      this.loading = 'Checking cache...'\n      let areaId = suggestion.areaId;\n\n      return request(config.areaServer + '/' + areaId + '.pbf', {\n        progress: this.generateNewProgressToken(),\n        responseType: 'arraybuffer'\n      }).then(arrayBuffer => {\n        var byteArray = new Uint8Array(arrayBuffer);\n        return byteArray;\n      }).then(byteArray => {\n        var Pbf = require('pbf');\n        var place = require('../proto/place.js').place;\n        var pbf = new Pbf(byteArray);\n        var obj = place.read(pbf);\n        let grid = Grid.fromPBF(obj)\n        this.$emit('loaded', grid);\n      });\n    },\n\n    useOSM(suggestion) {\n      if (suggestion.areaId && suggestion.osm_id) {\n        throw new Error('Cannot have both area id and osm id. Pick one');\n      }\n      this.loading = 'Connecting to OpenStreetMap...'\n      \n      // it may take a while to load data. \n      this.restartLoadingMonitor();\n      let queryString = getQuery(suggestion)\n      const query = new Query(queryString, this.generateNewProgressToken());\n      query.run().then(grid => {\n        this.loading = null;\n        if (!grid.hasRoads()) {\n          this.noRoads = true;\n        } else {\n          grid.setName(suggestion.name);\n          grid.setId(suggestion.areaId || suggestion.osm_id);\n          grid.setIsArea(suggestion.areaId); // osm nodes don't have area.\n          grid.setBBox(serializeBBox(suggestion.bbox));\n          this.$emit('loaded', grid);\n        }\n      }).catch(err => {\n        if (err.cancelled) {\n          this.loading = null;\n          return;\n        }\n        console.error(err);\n        this.error = err;\n        this.loading = null;\n        this.data = [];\n      })\n      .finally(() => {\n        clearInterval(this.notifyStillLoading);\n        this.stillLoading = 0;\n      });\n    },\n\n    cancelRequest() {\n      if (this.progressToken) {\n        this.progressToken.cancel();\n        this.progressToken = null;\n        this.loading = false;\n      }\n    },\n\n    generateNewProgressToken() {\n      if (this.progressToken) {\n        this.progressToken.cancel();\n        this.progressToken = null;\n      }\n\n      this.progressToken = new Progress(this.updateProgress);\n      return this.progressToken;\n    }\n  }\n}\n\nfunction getQuery(suggestion) {\n  let areaId = suggestion.areaId;\n  if (areaId) {\n    return `[timeout:900][maxsize:1073741824][out:json];\narea(${areaId});\n(._; )->.area;\n(\nway[highway](area.area);\nnode(w);\n);\nout skel;`;\n  } else {\n    let bbox = serializeBBox(suggestion.bbox);\n    return `[timeout:900][out:json][bbox:${bbox}];\n(\nway[highway];\nnode(w);\n);\nout skel(${bbox});`;\n  }\n}\n\nfunction serializeBBox(bbox) {\n  return bbox && bbox.join(',');\n}\n\nfunction formatNumber(x) {\n  if (!Number.isFinite(x)) return 'N/A';\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\nfunction restoreStateFromQueryString(name) {\n  let areaId = getCurrentAreaId();\n  if (areaId) {\n    return {name, areaId};\n  }\n\n  let nodeAndBox = getCurrentNodeAndBox();\n  if (nodeAndBox) {\n    return {\n      name,\n      osm_id: nodeAndBox.osm_id,\n      bbox: nodeAndBox.bbox\n    };\n  }\n}\n\nfunction getCurrentAreaId() {\n  let areaId = appState.get('areaId');\n  if (!Number.isFinite(Number.parseInt(areaId, 10))) {\n    areaId = null;\n  }\n  return areaId;\n}\n\nfunction getCurrentNodeAndBox() {\n  let osm_id = appState.get('osm_id');\n  if (!Number.isFinite(Number.parseInt(osm_id, 10))) return;\n\n  let bbox = parseBBox(appState.get('bbox'));\n  if (!bbox) return;\n\n  return { osm_id, bbox };\n}\n\nfunction parseBBox(bboxStr) {\n  if (!bboxStr) return null;\n\n  let bbox = bboxStr.split(',').map(x => Number.parseFloat(x)).filter(x => Number.isFinite(x));\n  return bbox.length === 4 ? bbox : null;\n}\n\n</script>\n\n<style lang=\"stylus\">\n@import('../vars.styl');\n.find-place  {\n  width: desktop-controls-width;\n}\n\nh3.site-header {\n  margin: 0;\n  font-weight: normal;\n  font-size: 32px;\n  text-align: center;\n}\n\ninput {\n  border: none;\n  flex: 1;\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  padding: 0;\n  color: #434343;\n  height: 100%;\n  font-size: 16px;\n  &:focus {\n    outline: none;\n  }\n}\n\n.search-box {\n  position: relative;\n  background-color: emphasis-background;\n  padding: 0 8px;\n  padding: 0 0 0 8px;\n\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n  height: 48px;\n  display: flex;\n  font-size: 16px;\n  cursor: text;\n  a {\n    cursor: pointer;\n  }\n  span {\n    display: flex;\n    align-items: center;\n    flex-shrink: 0;\n  }\n}\n\n.prompt {\n  padding: 4px;\n  text-align: center;\n  font-size: 12px;\n}\n\n.search-submit {\n  padding: 0 8px;\n  align-items: center;\n  text-decoration: none;\n  display: flex;\n  flex-shrink: 0;\n  justify-content: center;\n  outline: none;\n  color: highlight-color\n  &:hover {\n    color: emphasis-background;\n    background: highlight-color;\n  }\n}\n\n.suggestion {\n  display: block\n  min-height: 64px\n  align-items: center;\n  border-bottom: 1px solid border-color\n  display: flex\n  padding: 0 10px;\n  text-decoration: none\n  color: highlight-color\n}\n\n.suggestions {\n  position: relative;\n  background: white\n  .note {\n    font-size: 10px;\n    font-style: italic;\n  }\n\n  ul {\n    list-style-type: none;\n    margin: 0;\n    padding: 0;\n    max-height: calc(100vh - 128px);\n    overflow-y: auto;\n    overflow-x: hidden;\n  }\n}\n\n.message,\n.loading {\n  padding: 4px 8px;\n  position: relative;\n}\n.shadow {\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2)\n}\n\n.error {\n  overflow-x: auto;\n}\n\n.find-place {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  top: 8px;\n  left: 50%;\n\n  transform: translateX(-50%) translateY(0);\n  transition-timing-function: ease-out;\n  transition-property: top left transform;\n  transition-duration: 0.3s;\n}\n\n.find-place.centered {\n  top: 50%;\n  left: 50%;\n  transform: translateX(-50%) translateY(-143px);\n}\n.load-padding {\n  padding-left: 16px;\n}\n.description {\n  padding: 8px;\n  margin: 0;\n  text-align: center;\n}\n\n.cancel-request {\n  position: absolute;\n  right: 4px;\n  top: 4px;\n  font-size: 12px;\n}\n.error-links {\n  display: flex;\n  justify-content: space-between;\n  font-size: 12px;\n}\n\n@media (max-width: small-screen) {\n  .find-place {\n    width: 100%;\n  }\n  .find-place.centered {\n    top: 8px;\n    left: 0;\n    transform: none;\n  }\n  .message {\n    font-size: 12px;\n  }\n  .prompt {\n    font-size: 12px;\n    .note {\n      font-size: 9px;\n    }\n  }\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/FindPlace.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"find-place\",class:{centered: !_vm.suggestionsLoaded }},[(!_vm.suggestionsLoaded)?_c('div',[_c('h3',{staticClass:\"site-header\"},[_vm._v(\"city roads\")]),_vm._v(\" \"),_c('p',{staticClass:\"description\"},[_vm._v(\"This website renders every single road within a city\")])]):_vm._e(),_vm._v(\" \"),_c('form',{staticClass:\"search-box\",on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.enteredInput),expression:\"enteredInput\"}],ref:\"input\",staticClass:\"query-input\",attrs:{\"type\":\"text\",\"placeholder\":\"Enter a city name to start\"},domProps:{\"value\":(_vm.enteredInput)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.enteredInput=$event.target.value}}}),_vm._v(\" \"),(_vm.enteredInput && !_vm.hideInput)?_c('a',{staticClass:\"search-submit\",attrs:{\"type\":\"submit\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_vm._v(_vm._s(_vm.mainActionText))]):_vm._e()]),_vm._v(\" \"),(_vm.showWarning)?_c('div',{staticClass:\"prompt message note shadow\"},[_vm._v(\"\\n    Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render.\\n  \")]):_vm._e(),_vm._v(\" \"),(!_vm.loading)?_c('div',{staticClass:\"results\"},[(_vm.suggestionsLoaded && _vm.data.length)?_c('div',{staticClass:\"suggestions shadow\"},[_vm._m(0),_vm._v(\" \"),_c('ul',_vm._l((_vm.data),function(suggestion,index){return _c('li',{key:index},[_c('a',{staticClass:\"suggestion\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.pickSuggestion(suggestion)}}},[_c('span',[_vm._v(\"\\n          \"+_vm._s(suggestion.name)+\" \"),_c('small',[_vm._v(\"(\"+_vm._s(suggestion.type)+\")\")])])])])}),0)]):_vm._e(),_vm._v(\" \"),(_vm.suggestionsLoaded && !_vm.data.length && !_vm.loading && !_vm.error)?_c('div',{staticClass:\"no-results message shadow\"},[_vm._v(\"\\n      Didn't find matching cities. Try a different query?\\n    \")]):_vm._e(),_vm._v(\" \"),(_vm.noRoads)?_c('div',{staticClass:\"no-results message shadow\"},[_vm._v(\"\\n      Didn't find any roads. Try a different query?\\n    \")]):_vm._e()]):_vm._e(),_vm._v(\" \"),(_vm.error)?_c('div',{staticClass:\"error message shadow\"},[_c('div',[_vm._v(\"Sorry, we were not able to download data from the OpenStreetMap.\\n    It could be very busy at the moment processing other requests. \"),_c('br'),_c('br'),_vm._v(\" Please bookmark this website and \"),_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.retry($event)}}},[_vm._v(\"try again\")]),_vm._v(\" later?\")]),_vm._v(\" \"),_c('div',{staticClass:\"error-links\"},[_c('a',{attrs:{\"href\":\"https://twitter.com/anvaka/status/1218971717734789120\",\"title\":\"see what it supposed to do\",\"target\":\"_blank\"}},[_vm._v(\"see how it should have worked\")]),_vm._v(\" \"),_c('a',{attrs:{\"href\":_vm.getBugReportURL(_vm.error),\"title\":\"report error: \" + _vm.error,\"target\":\"_blank\"}},[_vm._v(\"report this bug\")])])]):_vm._e(),_vm._v(\" \"),(_vm.loading)?_c('div',{staticClass:\"loading message shadow\"},[_c('loading-icon'),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.loading))]),_vm._v(\" \"),_c('a',{staticClass:\"cancel-request\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.cancelRequest($event)}}},[_vm._v(\"cancel\")]),_vm._v(\" \"),(_vm.stillLoading > 0)?_c('div',{staticClass:\"load-padding\"},[_vm._v(\"\\n      Still loading...\\n    \")]):_vm._e(),_vm._v(\" \"),(_vm.stillLoading > 1)?_c('div',{staticClass:\"load-padding\"},[_vm._v(\"\\n      Sorry it takes so long!\\n    \")]):_vm._e()],1):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"prompt message\"},[_c('div',[_vm._v(\"Select boundaries below to download all roads within\")]),_vm._v(\" \"),_c('div',{staticClass:\"note\"},[_vm._v(\"large cities may require 200MB+ of data transfer and a powerful device\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-a971d568\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/FindPlace.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a971d568\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./FindPlace.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./FindPlace.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./FindPlace.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-a971d568\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./FindPlace.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/FindPlace.vue\n// module id = null\n// module chunks = ","// Based on https://github.com/ElemeFE/element/blob/dev/src/utils/clickoutside.js\n// The MIT License (MIT), Copyright (c) 2016 ElemeFE\nconst nodeList = [];\nconst ctx = '@@clickoutsideContext';\n\nlet startClick;\nlet seed = 0;\n\ndocument.addEventListener('mousedown', e => (startClick = e), true);\ndocument.addEventListener('mouseup', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n}, true);\n\n// Also hide when tapped outside.\ndocument.addEventListener('touchstart', e => {\n  startClick = e;\n}, true);\ndocument.addEventListener('touchend', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n}, true);\n\nfunction createDocumentHandler(el, binding, vnode) {\n  return function(mouseup = {}, mousedown = {}) {\n    if (!vnode || !vnode.context ||\n      !mouseup.target || !mousedown.target ||\n      el.contains(mouseup.target) ||\n      el.contains(mousedown.target) ||\n      el === mouseup.target ||\n      (vnode.context.popperElm &&\n      (vnode.context.popperElm.contains(mouseup.target) ||\n      vnode.context.popperElm.contains(mousedown.target)))) return;\n\n    const methodName = el[ctx].methodName;\n    if (binding.expression && methodName && vnode.context[methodName]) {\n      vnode.context[methodName]();\n    } else {\n      el[ctx].bindingFn && el[ctx].bindingFn();\n    }\n  };\n}\n\nexport default {\n  bind(el, binding, vnode) {\n    nodeList.push(el);\n    const id = seed++;\n    el[ctx] = {\n      id,\n      documentHandler: createDocumentHandler(el, binding, vnode),\n      methodName: binding.expression,\n      bindingFn: binding.value\n    };\n  },\n\n  update(el, binding, vnode) {\n    el[ctx].documentHandler = createDocumentHandler(el, binding, vnode);\n    el[ctx].methodName = binding.expression;\n    el[ctx].bindingFn = binding.value;\n  },\n\n  unbind(el) {\n    let len = nodeList.length;\n\n    for (let i = 0; i < len; i++) {\n      if (nodeList[i][ctx].id === el[ctx].id) {\n        nodeList.splice(i, 1);\n        break;\n      }\n    }\n    delete el[ctx];\n  }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/components/clickOutside.js","<template>\n  <div v-click-outside='looseFocus'>\n    <div class='editable-label'>\n      <span :class='{printable}'>{{value}}</span>\n      <input\n        v-bind:value=\"value\"\n        v-on:input=\"$emit('input', $event.target.value)\"\n        ref='input'\n      >\n    </div>\n  </div>\n</template>\n<script>\nimport ClickOutside from './clickOutside.js'\n\nexport default {\n  name: 'EditableLabel',\n  props: ['value', 'printable'],\n  directives: { ClickOutside },\n  methods: {\n    looseFocus() {\n      this.$refs.input.blur();\n    }\n  }\n}\n</script>\n<style lang=\"stylus\">\n@import('../vars.styl');\n\n.editable-label {\n  position: relative;\n\n  span {\n    position: relative;\n    top: 0;\n    left: 0;\n    display: flex;\n    align-items : center;\n    font-family: labels-font;\n    white-space: pre;\n    padding: 8px;\n    border: 1px solid transparent;\n  }\n\n  input {\n    caret-color: primary-text;\n    color: transparent;\n    font-family: labels-font;\n    background: transparent;\n    display: flex;\n    align-items: center;\n    position: absolute;\n    overflow: hidden;\n    top: 0;\n    left: 0;\n    width: 100%;\n    padding: 8px;\n    border: 1px solid transparent;\n    &:focus {\n      border: 1px dashed highlight-color;\n    }\n\n  }\n}\n  \n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/EditableLabel.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.looseFocus),expression:\"looseFocus\"}]},[_c('div',{staticClass:\"editable-label\"},[_c('span',{class:{printable: _vm.printable}},[_vm._v(_vm._s(_vm.value))]),_vm._v(\" \"),_c('input',{ref:\"input\",domProps:{\"value\":_vm.value},on:{\"input\":function($event){return _vm.$emit('input', $event.target.value)}}})])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1e35101e\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/EditableLabel.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1e35101e\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./EditableLabel.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./EditableLabel.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./EditableLabel.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1e35101e\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./EditableLabel.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/EditableLabel.vue\n// module id = null\n// module chunks = ","\n<template>\n<div class='vue-colorpicker' @click='showPicker = true' v-click-outside='hide' >\n  <span class='vue-colorpicker-btn' :style='btnStyle' ref='triggerButton'></span>\n  <div class='vue-colorpicker-panel' v-show='showPicker' :style=\"{left: panelLeft, top: panelTop}\">\n    <component :is='pickerType' v-model='colors' @input='changeColor'></component>\n  </div>\n</div>\n</template>\n\n<script>\nimport tinycolor from 'tinycolor2'\nimport { Sketch } from 'vue-color'\nimport ClickOutside from './clickOutside.js'\n\nexport default {\n  name: 'vue-colorpicker',\n  components: {\n    'sketch-picker': Sketch,\n  },\n  directives: { ClickOutside },\n  props: {\n    value: {\n      type: Object,\n    },\n  },\n  data () {\n    return {\n      showPicker: false,\n      colors: {\n        hex: '#FFFFFF',\n        a: 1\n      },\n      colorValue: '#FFFFFF',\n      panelLeft: '0px',\n      panelTop: '0px'\n    }\n  },\n  computed: {\n    pickerType () {\n      return 'sketch-picker';\n    },\n    isTransparent () {\n      return this.colors.a === 0;\n    },\n    btnStyle () {\n      if (this.isTransparent) {\n        return {\n          background: '#eee',\n          backgroundImage: 'linear-gradient(45deg, rgba(0,0,0,.25) 25%, transparent 0, transparent 75%,rgba(0,0,0,.25)0), linear-gradient(45deg, rgba(0,0,0,.25)25%,transparent 0, transparent 75%,rgba(0,0,0,.25)0)',\n          backgroundPosition: '0 0, 11px 11px',\n          backgroundSize: '22px 22px'\n        }\n      }\n      let {r, g, b, a} = this.colorValue;\n      return {\n        background: `rgba(${r}, ${g}, ${b}, ${a})`\n      }\n    },\n  },\n  watch: {\n    value (val, oldVal) {\n      if (val !== oldVal) {\n        this.updateColorObject(val);\n      }\n    },\n    showPicker(newVal) {\n      if (!newVal) return;\n\n      const PICKER_WIDTH = 220;\n      const PANEL_HEIGHT = 320;\n      let triggerRect = this.$refs.triggerButton.getBoundingClientRect();\n      let desiredLeft = triggerRect.x;\n      let desiredTop = triggerRect.bottom;\n      if (triggerRect.y + PANEL_HEIGHT > window.innerHeight) {\n        desiredTop = Math.max(0, window.innerHeight - PANEL_HEIGHT);\n        desiredLeft += 36; // so that the selector button is still visible;\n      }\n      if (desiredLeft + PICKER_WIDTH > window.innerWidth) {\n        desiredLeft = Math.max(0, window.innerWidth - PICKER_WIDTH);\n      } \n      this.panelLeft = desiredLeft + 'px';\n      this.panelTop = desiredTop + 'px';\n    }\n  },\n\n  methods: {\n    hide () {\n      this.showPicker = false;\n    },\n    changeColor (data) {\n      this.colorValue = data.rgba;\n      this.$emit('input', this.colorValue)\n      this.$emit('change', this.colorValue)\n    },\n    updateColorObject (color) {\n      if (!color) return\n      const colorObj = tinycolor(`rgba(${color.r}, ${color.g}, ${color.b}, ${color.a})` || 'transparent');\n      if (!color || color === 'transparent') {\n        this.colors = {\n          hex: '#FFFFFF',\n          hsl: { h: 0, s: 0, l: 1, a: 0 },\n          hsv: { h: 0, s: 0, v: 1, a: 0 },\n          rgba: { r: 255, g: 255, b: 255, a: 0 },\n          a: 0\n        };\n      } else {\n        this.colors = {\n          hex: colorObj.toHexString(),\n          hsl: colorObj.toHsl(),\n          hsv: colorObj.toHsv(),\n          rgba: colorObj.toRgb(),\n          a: colorObj.getAlpha()\n        };\n      }\n      this.colorValue = this.colors.rgba;\n    }\n  },\n  mounted () {\n    this.updateColorObject(this.value)\n  }\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n.vue-colorpicker {\n  display: inline-block;\n  box-sizing: border-box;\n  font-size: 0;\n  cursor: pointer;\n  &-btn {\n    display: inline-block;\n    width: 30px;\n    height: 22px;\n    border: 1px solid #666;\n    background: #FFFFFF;\n  }\n\n  .vue-colorpicker-panel {\n    position: absolute;\n    z-index: 1;\n  }\n}\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/ColorPicker.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.hide),expression:\"hide\"}],staticClass:\"vue-colorpicker\",on:{\"click\":function($event){_vm.showPicker = true}}},[_c('span',{ref:\"triggerButton\",staticClass:\"vue-colorpicker-btn\",style:(_vm.btnStyle)}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showPicker),expression:\"showPicker\"}],staticClass:\"vue-colorpicker-panel\",style:({left: _vm.panelLeft, top: _vm.panelTop})},[_c(_vm.pickerType,{tag:\"component\",on:{\"input\":_vm.changeColor},model:{value:(_vm.colors),callback:function ($$v) {_vm.colors=$$v},expression:\"colors\"}})],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-60c70430\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/ColorPicker.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-60c70430\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ColorPicker.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ColorPicker.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ColorPicker.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-60c70430\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./ColorPicker.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-60c70430\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/ColorPicker.vue\n// module id = null\n// module chunks = ","import Vue from 'vue';\n\n// we are going to use this as a global message bus inside the app.\nexport default new Vue();\n\n\n// WEBPACK FOOTER //\n// ./src/lib/bus.js","import bus from './bus';\n/**\n * This file is responsible for rendering of the grid. It uses my silly 2d webgl\n * renderer which is not very well documented, neither popular, yet it is very\n * fast.\n */\nconst wgl = require('w-gl');\n\nexport default function createScene(canvas) {\n  let scene = wgl.scene(canvas);\n  scene.on('transform', triggerTransform);\n\n  scene.setClearColor(0xf7/0xff, 0xf2/0xff, 0xe8/0xff, 1.0);\n\n  let slowDownZoom = false;\n  let layers = [];\n\n  listenToEvents();\n\n  return {\n    render() {\n      scene.renderFrame(true);\n    },\n\n    clear() {\n      layers.forEach(layer => layer.destroy());\n      scene.clear();\n    },\n\n    getLayers() {\n      return layers;\n    },\n\n    dispose() {\n      scene.clear();\n      scene.dispose();\n      unsubscribeFromEvents();\n    },\n\n    setLineColor(color) {\n      layers.forEach(layer => {\n        layer.color = color;\n      });\n    },\n\n    setBackground(color) {\n      scene.setClearColor(color.r/0xff, color.g/0xff, color.b/0xff, color.a);\n      scene.renderFrame();\n    },\n\n    add(gridLayer) {\n      if (layers.indexOf(gridLayer) > -1) return; // O(n).\n\n      gridLayer.bindToScene(scene);\n      layers.push(gridLayer);\n\n      if (layers.length === 1) {\n        // TODO: Should I do this for other layers?\n        let viewBox = gridLayer.getViewBox();\n        scene.setViewBox(viewBox);\n      }\n    },\n\n    getProjectedVisibleRect\n  };\n\n  function triggerTransform() {\n    bus.$emit('scene-transform');\n  }\n\n  function getProjectedVisibleRect() {\n    var leftTop = scene.getSceneCoordinate(0, 0);\n    var bottomRight = scene.getSceneCoordinate(window.innerWidth, window.innerHeight);\n    let rect = {\n      left: leftTop.x,\n      top: leftTop.y,\n      right: bottomRight.x,\n      bottom: bottomRight.y\n    };\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n\n    return rect;\n  }\n\n  function listenToEvents() {\n    document.addEventListener('keydown', onKeyDown, true);\n    document.addEventListener('keyup', onKeyUp, true);\n  }\n\n  function unsubscribeFromEvents() {\n    document.removeEventListener('keydown', onKeyDown, true);\n    document.removeEventListener('keyup', onKeyUp, true);\n  }\n\n  function onKeyDown(e) {\n    if (e.shiftKey) {\n      slowDownZoom = true;\n      scene.getPanzoom().setZoomSpeed(0.1);\n    } \n  }\n\n  function onKeyUp(e) {\n    if (!e.shiftKey && slowDownZoom) {\n      scene.getPanzoom().setZoomSpeed(1);\n      slowDownZoom = false;\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/createScene.js","import config from '../config';\nimport tinycolor from 'tinycolor2';\n\nconst wgl = require('w-gl');\nlet counter = 0;\n\nexport default class GridLayer {\n  get color() {\n    return this._color;\n  }\n\n  set color(unsafeColor) {\n    let color = tinycolor(unsafeColor);\n    this._color = color;\n    if (this.lines) {\n      this.lines.color = toRatioColor(color.toRgb());\n    }\n    if (this.scene) {\n      this.scene.renderFrame();\n    }\n  }\n\n  constructor() {\n    this._color = config.getDefaultLineColor();\n    this.grid = null;\n    this.lines = null;\n    this.scene = null;\n    this.dx = 0;\n    this.dy = 0;\n    this.scale = 1;\n    this.id = 'paths_' + counter;\n    counter += 1;\n  }\n\n  setGrid(grid) {\n    this.grid = grid;\n    if (this.scene) {\n      this.bindToScene(this.scene);\n    }\n  }\n\n  getViewBox() {\n    if (!this.grid) return null;\n\n    let {width, height} = this.grid.getProjectedRect();\n    let initialSceneSize = Math.max(width, height) / 4;\n    return {\n      left:  -initialSceneSize,\n      top:   -initialSceneSize,\n      right:  initialSceneSize,\n      bottom: initialSceneSize,\n    };\n  }\n\n  moveTo(x, y = 0) {\n    this.dx = x;\n    this.dy = y;\n\n    this._transferTransform();\n  }\n\n  moveBy(dx, dy = 0) {\n    this.dx += dx;\n    this.dy += dy;\n\n    this._transferTransform();\n  }\n\n  getLinesCollection() {\n    if (this.lines) return this.lines;\n\n    let grid = this.grid;\n    let lineWidth = 1;\n    let lines;\n    if (lineWidth < 2) {\n      // Wire collection cannot have width, this reduces amount of memory it needs\n      // though doesn't let us render nice thick lines.\n      lines = new wgl.WireCollection(grid.wayPointCount);\n      grid.forEachWay(function(from, to) {\n        lines.add({from, to});\n      });\n    }  else {\n      // This is not exposed anywhere, gives thick lines, though the caps are\n      // jagged.\n      lines = new wgl.LineCollection(grid.wayPointCount);\n      grid.forEachWay(function(from, to) {\n        let ui = lines.add({from, to});\n        ui.setWidth(lineWidth);\n        ui.update(from, to);\n      });\n    }\n\n    let color = tinycolor(this._color).toRgb();\n    lines.color = toRatioColor(color);\n\n    this.lines = lines;\n    return lines;\n  }\n\n  destroy() {\n    if (!this.scene || !this.lines) return;\n\n    this.scene.removeChild(this.lines);\n  }\n\n  bindToScene(scene) {\n    if (this.scene && this.lines) {\n      console.error('You seem to be adding this layer twice...')\n    }\n\n    this.scene = scene;\n    if (!this.grid) return;\n\n    let lines = this.getLinesCollection();\n    this.scene.appendChild(lines);\n  }\n\n  _transferTransform() {\n    if (!this.lines) return;\n\n    this.lines.transform.dx = this.dx;\n    this.lines.transform.dy = this.dy;\n    this.lines.transform.scale = this.scale;\n    this.lines.updateWorldTransform(true);\n    if (this.scene) {\n      this.scene.renderFrame(true);\n    }\n  }\n}\n\nfunction toRatioColor(c) {\n  return {r: c.r/0xff, g: c.g/0xff, b: c.b/0xff, a: c.a}\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/GridLayer.js","import request from './request';\nimport Progress from './Progress';\n\nlet imageUrl = 'https://edi6jgnosf.execute-api.us-west-2.amazonaws.com/Stage/put_image'\n\nconst productKinds = {\n  mug: '168739066664861503'\n};\n\nfunction getZazzleLink(kind, imageUrl) {\n  const productCode = productKinds[kind];\n  if (!productCode) {\n    throw new Error('Unknown product kind: ' + kind);\n  }\n\n  const imageEncoded = encodeURIComponent(imageUrl);\n  return `https://www.zazzle.com/api/create/at-238058511445368984?rf=238058511445368984&ax=Linkover&pd=${productCode}&ed=true&tc=&ic=&t_map_iid=${imageEncoded}`;\n}\n\nexport default function generateZazzleLink(canvas) {\n  var imageContent = canvas.toDataURL('image/png').replace(/^data:image\\/(png|jpg);base64,/, '');\n  const form = new FormData();\n  form.append('image', imageContent);\n\n  return request(imageUrl, {\n    method: 'POST',\n    responseType: 'json',\n    progress: new Progress(Function.prototype),\n    body: form,\n  }, 'POST').then(x => {\n    if (!x.success) throw new Error('Failed to upload image');\n    let link = x.data.link; \n    return getZazzleLink('mug', link);\n  }).catch(e => {\n    console.log('error', e);\n    throw e;\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/getZazzleLink.js","<template>\n<div>\n  <find-place v-if='!placeFound' @loaded='onGridLoaded'></find-place>\n  <div id=\"app\">\n    <div v-if='placeFound'>\n      <div class='controls'>\n        <a href=\"#\" class='print-button' @click.prevent='togglePrintWindow'>Customize...</a>\n        <a href=\"#\" class='try-another' @click.prevent='startOver'>Try another city</a>\n      </div>\n      <div v-if='showPrintWindow' class='print-window'>\n        <h3>Display</h3>\n        <div class='row'>\n          <div class='col'>Colors</div>\n          <div class='col colors c-2'>\n            <div class='color-container'>\n              <color-picker v-model='lineColor' @change='updateLinesColor'></color-picker>\n              <div class='color-label'>lines</div>\n            </div>\n\n            <div class='color-container'>\n              <color-picker v-model='backgroundColor' @change='updateBackground'></color-picker>\n              <div class='color-label'>background</div>\n            </div>\n\n            <div class='color-container'>\n              <color-picker v-model='labelColor'></color-picker>\n              <div class='color-label'>labels</div>\n            </div>\n          </div>\n        </div>\n\n        <h3>Export</h3>\n        <div class='row'>\n          <a href='#' @click.prevent='zazzleMugPrint()' class='col'>Onto a mug</a> \n          <span class='col c-2'>\n            Print what you see onto a mug. <br/>Get a unique gift of your favorite city.\n          </span>\n        </div>\n        <div class='preview-actions message' v-if='zazzleLink || generatingPreview'>\n            <div v-if='zazzleLink' class='padded popup-help'>\n              If your browser has blocked the new window, <br/>please <a :href='zazzleLink' target='_blank'>click here</a>\n              to open it.\n            </div>\n            <div v-if='generatingPreview' class='loading-container'>\n              <loading-icon></loading-icon>\n              Generating preview url...\n            </div>\n        </div>\n        <div class='row'>\n          <a href='#'  @click.prevent='toPNGFile' class='col'>As an image (.png)</a> \n          <span class='col c-2'>\n            Save the current screen as a raster image.\n          </span>\n        </div>\n        \n        <div class='row'>\n          <a href='#'  @click.prevent='toSVGFile' class='col'>As a vector (.svg)</a> \n          <span class='col c-2'>\n            Save the current screen as a vector image.\n          </span>\n        </div>\n        <div v-if='false' class='row'>\n          <a href='#' @click.prevent='toProtobuf' class='col'>To a .PBF file</a> \n          <span class='col c-2'>\n            Save the current data as a protobuf message. For developer use only.\n          </span>\n        </div>\n\n        <h3>About</h3>\n        <div>\n          <p>This website was created by <a href='https://twitter.com/anvaka' target='_blank'>@anvaka</a>.\n          It downloads roads from OpenStreetMap and renders them with WebGL.\n          </p>\n          <p>\n           You can find the entire <a href='https://github.com/anvaka/city-roads'>source code here</a>. \n           If you love this website you can also <a href='https://www.paypal.com/paypalme2/anvakos/3'>buy me a coffee</a>, but you don't have to!\n          </p>\n        </div>\n      </div>\n      <editable-label v-model='name' class='city-name' :printable='true' :style='{color: labelColorRGBA}'></editable-label>\n      <div class='license printable' :style='{color: labelColorRGBA}'>data <a href='https://www.openstreetmap.org/about/' target=\"_blank\" :style='{color: labelColorRGBA}'>© OpenStreetMap</a></div>\n    </div>\n  </div>\n  </div>\n</template>\n\n<script>\nimport FindPlace from './components/FindPlace';\nimport LoadingIcon from './components/LoadingIcon';\nimport EditableLabel from './components/EditableLabel';\nimport ColorPicker from './components/ColorPicker';\nimport createScene from './lib/createScene';\nimport GridLayer from './lib/GridLayer';\nimport generateZazzleLink from './lib/getZazzleLink';\nimport appState from './lib/appState';\nimport protobufExport from './lib/protobufExport';\nimport svgExport from './lib/svgExport';\nimport config from './config';\nimport './lib/canvas2BlobPolyfill';\nimport bus from './lib/bus';\n\nlet lastGrid;\n\nexport default {\n  name: 'App',\n  components: {\n    FindPlace,\n    LoadingIcon,\n    EditableLabel,\n    ColorPicker\n  },\n  data() {\n    return {\n      placeFound: false,\n      name: '',\n      zazzleLink: null,\n      generatingPreview: false,\n      showPrintWindow: false,\n      settingsOpen: false,\n      lineColor: config.getDefaultLineColor(),\n      labelColor: config.getLabelColor(),\n      backgroundColor: config.getBackgroundColor(),\n    }\n  },\n  computed: {\n    labelColorRGBA() {\n      return toRGBA(this.labelColor);\n    }\n  },\n  created() {\n    bus.$on('scene-transform', this.handleSceneTransform);\n  },\n  \n  beforeDestroy() {\n    this.dispose();\n    bus.$off('scene-transform', this.handleSceneTransform);\n  },\n  methods: {\n    dispose() {\n      if (this.scene) {\n        this.scene.dispose();\n        window.scene = null;\n      }\n    },\n    togglePrintWindow() {\n      this.showPrintWindow = !this.showPrintWindow;\n    },\n    handleSceneTransform() {\n      this.zazzleLink = null;\n    },\n    onGridLoaded(grid) {\n      if (grid.isArea) {\n        appState.set('areaId', grid.id);\n        appState.unset('osm_id');\n        appState.unset('bbox');\n      } else if (grid.bboxString) {\n        appState.unset('areaId');\n        appState.set('osm_id', grid.id);\n        appState.set('bbox', grid.bboxString);\n      }\n      this.placeFound = true;\n      this.name = grid.name.split(',')[0];\n      lastGrid = grid;\n      let canvas = getCanvas();\n      canvas.style.visibility = 'visible';\n\n      this.scene = createScene(canvas);\n      window.scene = this.scene;\n\n      let gridLayer = new GridLayer();\n      gridLayer.id = 'roads';\n      gridLayer.setGrid(grid);\n      this.scene.add(gridLayer)\n    },\n\n    startOver() {\n      appState.unset('areaId');\n      appState.unsetPlace();\n      appState.unset('q');\n\n      this.dispose();\n      this.placeFound = false;\n      this.zazzleLink = null;\n      this.showPrintWindow = false;\n      this.backgroundColor = config.getBackgroundColor();\n      this.lineColor = config.getDefaultLineColor();\n      this.labelColor = config.getLabelColor();\n\n      document.body.style.backgroundColor = config.getBackgroundColor(/* hexString = */ true);\n      getCanvas().style.visibility = 'hidden';\n    },\n\n    toPNGFile(e) {\n      let printableCanvas = this.getPrintableCanvas();\n      let fileName = this.getFileName();\n      printableCanvas.toBlob(function(blob) {\n        let url = window.URL.createObjectURL(blob);\n        let a = document.createElement(\"a\");\n        a.href = url;\n        a.download = fileName + '.png';\n        a.click();\n        window.URL.revokeObjectURL(url);\n      }, 'image/png')\n    },\n\n    toSVGFile(e) { \n      let visibleRect = this.scene.getProjectedVisibleRect();\n      let layers = this.scene.getLayers();\n\n      let svg = svgExport(layers, visibleRect, {\n        stroke: toHex(this.lineColor),\n        background: toHex(this.backgroundColor),\n        labels: collectText()\n      });\n      let blob = new Blob([svg], {type: \"image/svg+xml\"});\n      let url = window.URL.createObjectURL(blob);\n      // For some reason, safari doesn't like when download happens on the same\n      // event loop cycle. Pushing it to the next one.\n      setTimeout(() => {\n        let a = document.createElement(\"a\");\n        a.href = url;\n        a.download = lastGrid.id + '.svg';\n        a.click();\n        window.URL.revokeObjectURL(url);\n      }, 30)\n    },\n\n    getFileName(extension) {\n      let fileName = ((new Date().toISOString())).replace(/[\\s\\W]/g, '_');\n      return fileName + (extension || '');\n    },\n\n    toProtobuf(e) {\n      if (!lastGrid) return;\n\n      let arrayBuffer = protobufExport(lastGrid);\n      let blob = new Blob([arrayBuffer.buffer], {type: \"application/octet-stream\"});\n      let url = window.URL.createObjectURL(blob);\n      let a = document.createElement(\"a\");\n      a.href = url;\n      a.download = lastGrid.id + '.pbf';\n      a.click();\n      window.URL.revokeObjectURL(url);\n    },\n\n    updateLinesColor() {\n      this.scene.setLineColor(this.lineColor);\n      this.zazzleLink = null;\n    },\n\n    updateBackground() {\n      this.setBackgroundColor(this.backgroundColor)\n      this.zazzleLink = null;\n    },\n\n    setBackgroundColor(c) {\n      this.scene.setBackground(c);\n      document.body.style.backgroundColor = toRGBA(c);\n      this.zazzleLink = null;\n    },\n\n    zazzleMugPrint() {\n      if (this.zazzleLink) {\n        window.open(this.zazzleLink, '_blank');\n        recordOpenClick(this.zazzleLink);\n        return;\n      }\n\n      let printableCanvas = this.getPrintableCanvas();\n\n      this.generatingPreview = true;\n      generateZazzleLink(printableCanvas).then(link => {\n        this.zazzleLink = link;\n        window.open(link, '_blank');\n        recordOpenClick(link);\n        this.generatingPreview = false;\n      }).catch(e => {\n        this.error = e;\n        this.generatingPreview = false;\n      });\n    },\n\n    getPrintableCanvas() {\n      let cityCanvas = getCanvas();\n      let width = cityCanvas.width;\n      let height = cityCanvas.height;\n\n      let printable = document.createElement('canvas');\n      let ctx = printable.getContext('2d');\n      printable.width = width;\n      printable.height = height;\n      this.scene.render();\n      ctx.drawImage(cityCanvas, 0, 0, cityCanvas.width, cityCanvas.height, 0, 0, width, height);\n\n      if (appState.drawLabels) {\n        collectText().forEach(label => {\n          drawHtml(label, ctx);\n        })\n      }\n\n      return printable;\n    }\n  }\n}\n\nfunction collectText() {\n  return Array.from(\n    document.querySelectorAll('.printable')\n  ).map(element => {\n    let computedStyle = window.getComputedStyle(element);\n    let bounds = element.getBoundingClientRect();\n    let fontSize = Number.parseInt(computedStyle.fontSize, 10);\n\n    return {\n      text: element.innerText,\n      bounds,\n      fontSize,\n      color: computedStyle.color,\n      fontFamily: computedStyle.fontFamily,\n      fill: computedStyle.color,\n    }\n  });\n}\n\nfunction toRGBA(c) {\n    return `rgba(${c.r}, ${c.g}, ${c.b}, ${c.a})`;\n}\n\nfunction drawHtml(element, ctx) {\n  if (!element) return;\n\n  ctx.save();\n\n  let dpr = window.devicePixelRatio || 1;\n  ctx.font = dpr * element.fontSize + 'px ' + element.fontFamily;\n  ctx.fillStyle = element.color;\n  ctx.textAlign = 'end'\n  ctx.fillText(element.text, element.bounds.right * dpr, element.bounds.bottom * dpr)\n  ctx.restore();\n}\n\nfunction getCanvas() {\n  return document.querySelector('#canvas')\n}\n\nfunction toHex(color) {\n  return `#${hex(color.r)}${hex(color.g)}${hex(color.b)}`;\n}\n\nfunction hex(x) {\n  if (x === 0) return '00';\n  let hexValue = x.toString(16)\n  return x < 16 ? '0' + hexValue : hexValue;\n}\n\nfunction recordOpenClick(link) {\n  if (typeof ga === 'undefined') return;\n\n  ga('send', 'event', {\n      eventCategory: 'Outbound Link',\n      eventAction: 'click',\n      eventLabel: link\n    });\n}\n</script>\n\n<style lang='stylus'>\n@import('./vars.styl');\n\n#app {\n  margin: 8px;\n  max-height: 100vh;\n  position: absolute;\n  h3 {\n    font-weight: normal;\n  }\n}\n\n.controls {\n  height: 48px;\n  background: white;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n  width: desktop-controls-width;\n  justify-content: space-around;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n\n  a {\n    text-decoration: none;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: highlight-color;\n    margin: 0;\n    border: 0;\n    &:hover {\n      color: emphasis-background;\n      background: highlight-color;\n    }\n  }\n  a.try-another {\n    flex: 1;\n  }\n\n  a.print-button {\n    flex: 1;\n    border-right: 1px solid border-color;\n    &:focus {\n      border: 1px dashed highlight-color;\n    }\n  }\n}\n\n.col {\n    display: flex;\n    flex: 1;\n    select {\n      margin-left: 14px;\n    }\n  }\n.row {\n  margin-top: 4px;\n  display: flex;\n  flex-direction: row;\n  min-height: 32px;\n}\n.colors {\n  display: flex;\n  flex-direction: row;\n\n  .color-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 64px;\n  }\n\n  .color-label {\n    font-size: 12px;\n  }\n}\n\na {\n  border: 1px solid transparent;\n  margin: -1px;\n  text-decoration: none;\n  color: highlight-color\n}\na:focus {\n  border: 1px dashed highlight-color;\n  outline: none;\n}\n.print-window {\n  max-height: calc(100vh - 48px);\n  overflow-y: auto;\n  border-top: 1px solid border-color;\n  background: white;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n  width: desktop-controls-width;\n  padding: 8px;\n  .row a {\n    margin-right: 4px;\n  }\n\n  h3 {\n    margin: 8px 0;\n    text-align: right;\n  }\n}\n\n.message {\n  border-top: 1px solid border-color\n  border-bottom: 1px solid border-color\n  background: #F5F5F5;\n}\n\n.preview-actions {\n  display: flex;\n  padding: 8px 0;\n  margin-left: -8px;\n  margin-bottom: 14px;\n  margin-top: 1px;\n  width: desktop-controls-width;\n  flex-direction: column;\n  align-items: stretch;\n  font-size: 14px;\n  align-items: center;\n  display: flex;\n\n  .popup-help {\n    text-align: center;\n  }\n}\n\n.city-name {\n  position: fixed;\n  right: 32px;\n  bottom: 54px;\n  font-size: 24px;\n  color: #434343;\n  input {\n    font-size: 24px;\n  }\n}\n\n.license {\n  text-align: right;\n  position: fixed;\n  font-family: labels-font;\n  right: 32px;\n  bottom: 32px;\n  font-size: 12px;\n  padding-right: 8px;\n  a {\n    text-decoration: none;\n    display: inline-block;\n  }\n}\n\n.c-2 {\n  flex: 2\n}\n\n@media (max-width: small-screen) {\n  #app {\n    width: 100%;\n    margin: 0;\n\n    .preview-actions,.error,\n    .controls, .print-window {\n      width: 100%;\n    }\n    .loading-container {\n      font-size: 12px;\n    }\n\n    .license  {\n      right: 8px;\n      bottom: 8px;\n    }\n    .print-window {\n      font-size: 14px;\n    }\n\n    .city-name  {\n      right: 8px;\n      bottom: 24px;\n    }\n  }\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(!_vm.placeFound)?_c('find-place',{on:{\"loaded\":_vm.onGridLoaded}}):_vm._e(),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"app\"}},[(_vm.placeFound)?_c('div',[_c('div',{staticClass:\"controls\"},[_c('a',{staticClass:\"print-button\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.togglePrintWindow($event)}}},[_vm._v(\"Customize...\")]),_vm._v(\" \"),_c('a',{staticClass:\"try-another\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.startOver($event)}}},[_vm._v(\"Try another city\")])]),_vm._v(\" \"),(_vm.showPrintWindow)?_c('div',{staticClass:\"print-window\"},[_c('h3',[_vm._v(\"Display\")]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col\"},[_vm._v(\"Colors\")]),_vm._v(\" \"),_c('div',{staticClass:\"col colors c-2\"},[_c('div',{staticClass:\"color-container\"},[_c('color-picker',{on:{\"change\":_vm.updateLinesColor},model:{value:(_vm.lineColor),callback:function ($$v) {_vm.lineColor=$$v},expression:\"lineColor\"}}),_vm._v(\" \"),_c('div',{staticClass:\"color-label\"},[_vm._v(\"lines\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"color-container\"},[_c('color-picker',{on:{\"change\":_vm.updateBackground},model:{value:(_vm.backgroundColor),callback:function ($$v) {_vm.backgroundColor=$$v},expression:\"backgroundColor\"}}),_vm._v(\" \"),_c('div',{staticClass:\"color-label\"},[_vm._v(\"background\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"color-container\"},[_c('color-picker',{model:{value:(_vm.labelColor),callback:function ($$v) {_vm.labelColor=$$v},expression:\"labelColor\"}}),_vm._v(\" \"),_c('div',{staticClass:\"color-label\"},[_vm._v(\"labels\")])],1)])]),_vm._v(\" \"),_c('h3',[_vm._v(\"Export\")]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.zazzleMugPrint()}}},[_vm._v(\"Onto a mug\")]),_vm._v(\" \"),_vm._m(0)]),_vm._v(\" \"),(_vm.zazzleLink || _vm.generatingPreview)?_c('div',{staticClass:\"preview-actions message\"},[(_vm.zazzleLink)?_c('div',{staticClass:\"padded popup-help\"},[_vm._v(\"\\n              If your browser has blocked the new window, \"),_c('br'),_vm._v(\"please \"),_c('a',{attrs:{\"href\":_vm.zazzleLink,\"target\":\"_blank\"}},[_vm._v(\"click here\")]),_vm._v(\"\\n              to open it.\\n            \")]):_vm._e(),_vm._v(\" \"),(_vm.generatingPreview)?_c('div',{staticClass:\"loading-container\"},[_c('loading-icon'),_vm._v(\"\\n              Generating preview url...\\n            \")],1):_vm._e()]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toPNGFile($event)}}},[_vm._v(\"As an image (.png)\")]),_vm._v(\" \"),_c('span',{staticClass:\"col c-2\"},[_vm._v(\"\\n            Save the current screen as a raster image.\\n          \")])]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toSVGFile($event)}}},[_vm._v(\"As a vector (.svg)\")]),_vm._v(\" \"),_c('span',{staticClass:\"col c-2\"},[_vm._v(\"\\n            Save the current screen as a vector image.\\n          \")])]),_vm._v(\" \"),(false)?_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toProtobuf($event)}}},[_vm._v(\"To a .PBF file\")]),_vm._v(\" \"),_c('span',{staticClass:\"col c-2\"},[_vm._v(\"\\n            Save the current data as a protobuf message. For developer use only.\\n          \")])]):_vm._e(),_vm._v(\" \"),_c('h3',[_vm._v(\"About\")]),_vm._v(\" \"),_vm._m(1)]):_vm._e(),_vm._v(\" \"),_c('editable-label',{staticClass:\"city-name\",style:({color: _vm.labelColorRGBA}),attrs:{\"printable\":true},model:{value:(_vm.name),callback:function ($$v) {_vm.name=$$v},expression:\"name\"}}),_vm._v(\" \"),_c('div',{staticClass:\"license printable\",style:({color: _vm.labelColorRGBA})},[_vm._v(\"data \"),_c('a',{style:({color: _vm.labelColorRGBA}),attrs:{\"href\":\"https://www.openstreetmap.org/about/\",\"target\":\"_blank\"}},[_vm._v(\"© OpenStreetMap\")])])],1):_vm._e()])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"col c-2\"},[_vm._v(\"\\n            Print what you see onto a mug. \"),_c('br'),_vm._v(\"Get a unique gift of your favorite city.\\n          \")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',[_vm._v(\"This website was created by \"),_c('a',{attrs:{\"href\":\"https://twitter.com/anvaka\",\"target\":\"_blank\"}},[_vm._v(\"@anvaka\")]),_vm._v(\".\\n          It downloads roads from OpenStreetMap and renders them with WebGL.\\n          \")]),_vm._v(\" \"),_c('p',[_vm._v(\"\\n           You can find the entire \"),_c('a',{attrs:{\"href\":\"https://github.com/anvaka/city-roads\"}},[_vm._v(\"source code here\")]),_vm._v(\". \\n           If you love this website you can also \"),_c('a',{attrs:{\"href\":\"https://www.paypal.com/paypalme2/anvakos/3\"}},[_vm._v(\"buy me a coffee\")]),_vm._v(\", but you don't have to!\\n          \")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-454f175a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-454f175a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-454f175a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"absolute no-webgl\"},[_c('h3',[_vm._v(\"WebGL is not enabled :(\")]),_vm._v(\" \"),_c('p',[_vm._v(\"This website renders millions of roads at once.\")]),_vm._v(\" \"),_c('p',[_vm._v(\"\\n    To render this amount of data fast, the website uses \"),_c('a',{attrs:{\"href\":\"https://get.webgl.org/\"}},[_vm._v(\"WebGL\")]),_vm._v(\",\\n    which seem to be not supported by the device that you are using.\\n  \")]),_vm._v(\" \"),_c('p',[_vm._v(\"Please try a different device to play with this website\")]),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"https://i.imgur.com/Fbbe5a6.png\",\"alt\":\"demo\"}})])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4c133b01\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/NoWebGL.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4c133b01\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./NoWebGL.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nvar __vue_script__ = null\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4c133b01\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./NoWebGL.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4c133b01\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/NoWebGL.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nimport NoWebGL from './NoWebGL'\nimport load from './lib/load';\n\nconst wgl = require('w-gl');\n\nwindow.addEventListener('error', logError);\n\nVue.config.productionTip = false\n\n// expose the console API\nwindow.load = load;\n\nif (wgl.isWebGLEnabled(document.querySelector('#canvas'))) {\n  /* eslint-disable no-new */\n  new Vue({\n    el: '#app',\n    components: { App },\n    template: '<App/>'\n  })\n} else {\n  new Vue({\n    el: '#app',\n    components: { NoWebGL },\n    template: '<NoWebGL/>'\n  })\n}\n\nfunction logError(e) {\n  if (typeof ga !== 'function') return;\n\n  const exDescription = e ? `${e.message} in ${e.filename}:${e.lineno}` : 'Unknown exception';\n\n  ga('send', 'exception', {\n    exDescription,\n    exFatal: false\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","import GridLayer from './GridLayer';\nimport Query from './Query';\n\n/**\n * Experimental API. Can be changed/removed at any point.\n */\nexport default function load(queryFilter, place) {\n  let layer = new GridLayer();\n  layer.query = Query.all(queryFilter, place);\n  layer.query.run().then(grid => {\n    layer.setGrid(grid);\n  }).catch(e => {\n    console.error(`Could not execute:\n${queryFilter}\nThe error was:`);\n    console.error(e);\n    layer.destroy();\n  });\n\n  if (window.scene !== undefined) {\n    window.scene.add(layer);\n  }\n  return layer;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/load.js","/*!\n * wgl v0.7.2\n * (c) 2017 Andrei Kashcha.\n * Released under the MIT License.\n */\n/**\n * This module used to unify mouse wheel behavior between different browsers in 2014\n * Now it's just a wrapper around addEventListener('wheel');\n *\n * Usage:\n *  var addWheelListener = require('wheel').addWheelListener;\n *  var removeWheelListener = require('wheel').removeWheelListener;\n *  addWheelListener(domElement, function (e) {\n *    // mouse wheel event\n *  });\n *  removeWheelListener(domElement, function);\n */\n\nvar wheel = addWheelListener;\n\n// But also expose \"advanced\" api with unsubscribe:\nvar addWheelListener_1 = addWheelListener;\nvar removeWheelListener_1 = removeWheelListener;\n\n\nfunction addWheelListener(element, listener, useCapture) {\n  element.addEventListener('wheel', listener, useCapture);\n}\n\nfunction removeWheelListener( element, listener, useCapture ) {\n  element.removeEventListener('wheel', listener, useCapture);\n}\n\nwheel.addWheelListener = addWheelListener_1;\nwheel.removeWheelListener = removeWheelListener_1;\n\n/**\n * https://github.com/gre/bezier-easing\n * BezierEasing - use bezier curve for transition easing function\n * by Gaëtan Renaudeau 2014 - 2015 – MIT License\n */\n\n// These values are established by empiricism with tests (tradeoff: performance VS precision)\nvar NEWTON_ITERATIONS = 4;\nvar NEWTON_MIN_SLOPE = 0.001;\nvar SUBDIVISION_PRECISION = 0.0000001;\nvar SUBDIVISION_MAX_ITERATIONS = 10;\n\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nvar float32ArraySupported = typeof Float32Array === 'function';\n\nfunction A (aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1; }\nfunction B (aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1; }\nfunction C (aA1)      { return 3.0 * aA1; }\n\n// Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\nfunction calcBezier (aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT; }\n\n// Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\nfunction getSlope (aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1); }\n\nfunction binarySubdivide (aX, aA, aB, mX1, mX2) {\n  var currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n  return currentT;\n}\n\nfunction newtonRaphsonIterate (aX, aGuessT, mX1, mX2) {\n for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n   var currentSlope = getSlope(aGuessT, mX1, mX2);\n   if (currentSlope === 0.0) {\n     return aGuessT;\n   }\n   var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n   aGuessT -= currentX / currentSlope;\n }\n return aGuessT;\n}\n\nfunction LinearEasing (x) {\n  return x;\n}\n\nvar src = function bezier (mX1, mY1, mX2, mY2) {\n  if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) {\n    throw new Error('bezier x values must be in [0, 1] range');\n  }\n\n  if (mX1 === mY1 && mX2 === mY2) {\n    return LinearEasing;\n  }\n\n  // Precompute samples table\n  var sampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n  for (var i = 0; i < kSplineTableSize; ++i) {\n    sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n  }\n\n  function getTForX (aX) {\n    var intervalStart = 0.0;\n    var currentSample = 1;\n    var lastSample = kSplineTableSize - 1;\n\n    for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n      intervalStart += kSampleStepSize;\n    }\n    --currentSample;\n\n    // Interpolate to provide an initial guess for t\n    var dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n    var guessForT = intervalStart + dist * kSampleStepSize;\n\n    var initialSlope = getSlope(guessForT, mX1, mX2);\n    if (initialSlope >= NEWTON_MIN_SLOPE) {\n      return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n    } else if (initialSlope === 0.0) {\n      return guessForT;\n    } else {\n      return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n    }\n  }\n\n  return function BezierEasing (x) {\n    // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n    if (x === 0) {\n      return 0;\n    }\n    if (x === 1) {\n      return 1;\n    }\n    return calcBezier(getTForX(x), mY1, mY2);\n  };\n};\n\n// Predefined set of animations. Similar to CSS easing functions\nvar animations = {\n  ease:  src(0.25, 0.1, 0.25, 1),\n  easeIn: src(0.42, 0, 1, 1),\n  easeOut: src(0, 0, 0.58, 1),\n  easeInOut: src(0.42, 0, 0.58, 1),\n  linear: src(0, 0, 1, 1)\n};\n\n\nvar amator = animate;\nvar makeAggregateRaf_1 = makeAggregateRaf;\nvar sharedScheduler = makeAggregateRaf();\n\n\nfunction animate(source, target, options) {\n  var start = Object.create(null);\n  var diff = Object.create(null);\n  options = options || {};\n  // We let clients specify their own easing function\n  var easing = (typeof options.easing === 'function') ? options.easing : animations[options.easing];\n\n  // if nothing is specified, default to ease (similar to CSS animations)\n  if (!easing) {\n    if (options.easing) {\n      console.warn('Unknown easing function in amator: ' + options.easing);\n    }\n    easing = animations.ease;\n  }\n\n  var step = typeof options.step === 'function' ? options.step : noop$1;\n  var done = typeof options.done === 'function' ? options.done : noop$1;\n\n  var scheduler = getScheduler(options.scheduler);\n\n  var keys = Object.keys(target);\n  keys.forEach(function(key) {\n    start[key] = source[key];\n    diff[key] = target[key] - source[key];\n  });\n\n  var durationInMs = typeof options.duration === 'number' ? options.duration : 400;\n  var durationInFrames = Math.max(1, durationInMs * 0.06); // 0.06 because 60 frames pers 1,000 ms\n  var previousAnimationId;\n  var frame = 0;\n\n  previousAnimationId = scheduler.next(loop);\n\n  return {\n    cancel: cancel\n  }\n\n  function cancel() {\n    scheduler.cancel(previousAnimationId);\n    previousAnimationId = 0;\n  }\n\n  function loop() {\n    var t = easing(frame/durationInFrames);\n    frame += 1;\n    setValues(t);\n    if (frame <= durationInFrames) {\n      previousAnimationId = scheduler.next(loop);\n      step(source);\n    } else {\n      previousAnimationId = 0;\n      setTimeout(function() { done(source); }, 0);\n    }\n  }\n\n  function setValues(t) {\n    keys.forEach(function(key) {\n      source[key] = diff[key] * t + start[key];\n    });\n  }\n}\n\nfunction noop$1() { }\n\nfunction getScheduler(scheduler) {\n  if (!scheduler) {\n    var canRaf = typeof window !== 'undefined' && window.requestAnimationFrame;\n    return canRaf ? rafScheduler() : timeoutScheduler()\n  }\n  if (typeof scheduler.next !== 'function') { throw new Error('Scheduler is supposed to have next(cb) function') }\n  if (typeof scheduler.cancel !== 'function') { throw new Error('Scheduler is supposed to have cancel(handle) function') }\n\n  return scheduler\n}\n\nfunction rafScheduler() {\n  return {\n    next: window.requestAnimationFrame.bind(window),\n    cancel: window.cancelAnimationFrame.bind(window)\n  }\n}\n\nfunction timeoutScheduler() {\n  return {\n    next: function(cb) {\n      return setTimeout(cb, 1000/60)\n    },\n    cancel: function (id) {\n      return clearTimeout(id)\n    }\n  }\n}\n\nfunction makeAggregateRaf() {\n  var frontBuffer = new Set();\n  var backBuffer = new Set();\n  var frameToken = 0;\n\n  return {\n    next: next,\n    cancel: next,\n    clearAll: clearAll\n  }\n\n  function clearAll() {\n    frontBuffer.clear();\n    backBuffer.clear();\n    cancelAnimationFrame(frameToken);\n    frameToken = 0;\n  }\n\n  function next(callback) {\n    backBuffer.add(callback);\n    renderNextFrame();\n  }\n\n  function renderNextFrame() {\n    if (!frameToken) { frameToken = requestAnimationFrame(renderFrame); }\n  }\n\n  function renderFrame() {\n    frameToken = 0;\n\n    var t = backBuffer;\n    backBuffer = frontBuffer;\n    frontBuffer = t;\r\n\n    frontBuffer.forEach(function(callback) {\n      callback();\n    });\n    frontBuffer.clear();\n  }\n\n  \n}\n\namator.makeAggregateRaf = makeAggregateRaf_1;\namator.sharedScheduler = sharedScheduler;\n\nvar ngraph_events$1 = function(subject) {\n  validateSubject(subject);\n\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n/**\n * Allows smooth kinetic scrolling of the surface\n */\nvar kinetic_1 = kinetic;\n\nfunction kinetic(getPoint, scroll, settings) {\n  if (typeof settings !== 'object') {\n    // setting could come as boolean, we should ignore it, and use an object.\n    settings = {};\n  }\n\n  var minVelocity = typeof settings.minVelocity === 'number' ? settings.minVelocity : 5;\n  var amplitude = typeof settings.amplitude === 'number' ? settings.amplitude : 0.25;\n  var cancelAnimationFrame = typeof settings.cancelAnimationFrame === 'function' ? settings.cancelAnimationFrame : getCancelAnimationFrame();\n  var requestAnimationFrame = typeof settings.requestAnimationFrame === 'function' ? settings.requestAnimationFrame : getRequestAnimationFrame();\n\n  var lastPoint;\n  var timestamp;\n  var timeConstant = 342;\n\n  var ticker;\n  var vx, targetX, ax;\n  var vy, targetY, ay;\n\n  var raf;\n\n  return {\n    start: start,\n    stop: stop,\n    cancel: dispose\n  };\n\n  function dispose() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n  }\n\n  function start() {\n    lastPoint = getPoint();\n\n    ax = ay = vx = vy = 0;\n    timestamp = new Date();\n\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n\n    // we start polling the point position to accumulate velocity\n    // Once we stop(), we will use accumulated velocity to keep scrolling\n    // an object.\n    ticker = requestAnimationFrame(track);\n  }\n\n  function track() {\n    var now = Date.now();\n    var elapsed = now - timestamp;\n    timestamp = now;\n\n    var currentPoint = getPoint();\n\n    var dx = currentPoint.x - lastPoint.x;\n    var dy = currentPoint.y - lastPoint.y;\n\n    lastPoint = currentPoint;\n\n    var dt = 1000 / (1 + elapsed);\n\n    // moving average\n    vx = 0.8 * dx * dt + 0.2 * vx;\n    vy = 0.8 * dy * dt + 0.2 * vy;\n\n    ticker = requestAnimationFrame(track);\n  }\n\n  function stop() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n\n    var currentPoint = getPoint();\n\n    targetX = currentPoint.x;\n    targetY = currentPoint.y;\n    timestamp = Date.now();\n\n    if (vx < -minVelocity || vx > minVelocity) {\n      ax = amplitude * vx;\n      targetX += ax;\n    }\n\n    if (vy < -minVelocity || vy > minVelocity) {\n      ay = amplitude * vy;\n      targetY += ay;\n    }\n\n    raf = requestAnimationFrame(autoScroll);\n  }\n\n  function autoScroll() {\n    var elapsed = Date.now() - timestamp;\n\n    var moving = false;\n    var dx = 0;\n    var dy = 0;\n\n    if (ax) {\n      dx = -ax * Math.exp(-elapsed / timeConstant);\n\n      if (dx > 0.5 || dx < -0.5) { moving = true; }\n      else { dx = ax = 0; }\n    }\n\n    if (ay) {\n      dy = -ay * Math.exp(-elapsed / timeConstant);\n\n      if (dy > 0.5 || dy < -0.5) { moving = true; }\n      else { dy = ay = 0; }\n    }\n\n    if (moving) {\n      scroll(targetX + dx, targetY + dy);\n      raf = requestAnimationFrame(autoScroll);\n    }\n  }\n}\n\nfunction getCancelAnimationFrame() {\n  if (typeof commonjsGlobal.cancelAnimationFrame === 'function') { return commonjsGlobal.cancelAnimationFrame; }\n\n  return clearTimeout;\n}\n\nfunction getRequestAnimationFrame() {\n  if (typeof commonjsGlobal.requestAnimationFrame === 'function') { return commonjsGlobal.requestAnimationFrame; }\n\n  return function (handler) {\n    return setTimeout(handler, 16);\n  }\n}\n\n/**\n * Disallows selecting text.\n */\nvar createTextSelectionInterceptor_1 = createTextSelectionInterceptor;\n\nfunction createTextSelectionInterceptor(useFake) {\n  if (useFake) {\n    return {\n      capture: noop$2,\n      release: noop$2\n    };\n  }\n\n  var dragObject;\n  var prevSelectStart;\n  var prevDragStart;\n  var wasCaptured = false;\n\n  return {\n    capture: capture,\n    release: release\n  };\n\n  function capture(domObject) {\n    wasCaptured = true;\n    prevSelectStart = window.document.onselectstart;\n    prevDragStart = window.document.ondragstart;\n\n    window.document.onselectstart = disabled;\n\n    dragObject = domObject;\n    dragObject.ondragstart = disabled;\n  }\n\n  function release() {\n    if (!wasCaptured) { return; }\n    \n    wasCaptured = false;\n    window.document.onselectstart = prevSelectStart;\n    if (dragObject) { dragObject.ondragstart = prevDragStart; }\n  }\n}\n\nfunction disabled(e) {\n  e.stopPropagation();\n  return false;\n}\n\nfunction noop$2() {}\n\nvar transform = Transform;\n\nfunction Transform() {\n  this.x = 0;\n  this.y = 0;\n  this.scale = 1;\n}\n\nvar svgController = makeSvgController;\n\nfunction makeSvgController(svgElement, options) {\n  var elementValid = (svgElement instanceof SVGElement);\n  if (!elementValid) {\n    throw new Error('svg element is required for svg.panzoom to work')\n  }\n\n  var owner = svgElement.ownerSVGElement;\n  if (!owner) {\n    throw new Error(\n      'Do not apply panzoom to the root <svg> element. ' +\n      'Use its child instead (e.g. <g></g>). ' +\n      'As of March 2016 only FireFox supported transform on the root element')\n  }\n\n  if (!options.disableKeyboardInteraction) {\n    owner.setAttribute('tabindex', 0);\n  }\n\n  var api = {\n    getBBox: getBBox,\n    getScreenCTM: getScreenCTM,\n    getOwner: getOwner,\n    applyTransform: applyTransform,\n    initTransform: initTransform\n  };\n  \n  return api\n\n  function getOwner() {\n    return owner\n  }\n\n  function getBBox() {\n    var bbox =  svgElement.getBBox();\n    return {\n      left: bbox.x,\n      top: bbox.y,\n      width: bbox.width,\n      height: bbox.height,\n    }\n  }\n\n  function getScreenCTM() {\n    var ctm = owner.getCTM();\n    if (!ctm) {\n      // This is likely firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=873106\n      // The code below is not entirely correct, but still better than nothing\n      return owner.getScreenCTM();\n    }\n    return ctm;\n  }\n\n  function initTransform(transform) {\n    var screenCTM = svgElement.getCTM();\n    transform.x = screenCTM.e;\n    transform.y = screenCTM.f;\n    transform.scale = screenCTM.a;\n    owner.removeAttributeNS(null, 'viewBox');\n  }\n\n  function applyTransform(transform) {\n    svgElement.setAttribute('transform', 'matrix(' +\n      transform.scale + ' 0 0 ' +\n      transform.scale + ' ' +\n      transform.x + ' ' + transform.y + ')');\n  }\n}\n\nvar domController = makeDomController;\n\nfunction makeDomController(domElement, options) {\n  var elementValid = (domElement instanceof HTMLElement);\n  if (!elementValid) {\n    throw new Error('svg element is required for svg.panzoom to work')\n  }\n\n  var owner = domElement.parentElement;\n  if (!owner) {\n    throw new Error(\n      'Do not apply panzoom to the detached DOM element. '\n    )\n  }\n\n  domElement.scrollTop = 0;\n  \n  if (!options.disableKeyboardInteraction) {\n    owner.setAttribute('tabindex', 0);\n  }\n\n  var api = {\n    getBBox: getBBox,\n    getOwner: getOwner,\n    applyTransform: applyTransform,\n  };\n  \n  return api\n\n  function getOwner() {\n    return owner\n  }\n\n  function getBBox() {\n    // TODO: We should probably cache this?\n    return  {\n      left: 0,\n      top: 0,\n      width: domElement.clientWidth,\n      height: domElement.clientHeight\n    }\n  }\n\n  function applyTransform(transform) {\n    // TODO: Should we cache this?\n    domElement.style.transformOrigin = '0 0 0';\n    domElement.style.transform = 'matrix(' +\n      transform.scale + ', 0, 0, ' +\n      transform.scale + ', ' +\n      transform.x + ', ' + transform.y + ')';\n  }\n}\n\n'use strict';\n\n/* globals SVGElement */\n/**\n * Allows to drag and zoom svg elements\n */\n\n\n\n\n\nvar domTextSelectionInterceptor = createTextSelectionInterceptor_1();\nvar fakeTextSelectorInterceptor = createTextSelectionInterceptor_1(true);\n\n\n\n\nvar defaultZoomSpeed = 1;\nvar defaultDoubleTapZoomSpeed = 1.75;\nvar doubleTapSpeedInMS = 300;\n\nvar panzoom = createPanZoom;\n\n/**\n * Creates a new instance of panzoom, so that an object can be panned and zoomed\n *\n * @param {DOMElement} domElement where panzoom should be attached.\n * @param {Object} options that configure behavior.\n */\nfunction createPanZoom(domElement, options) {\n  options = options || {};\n\n  var panController = options.controller;\n\n  if (!panController) {\n    if (domElement instanceof SVGElement) {\n      panController = svgController(domElement, options);\n    }\n\n    if (domElement instanceof HTMLElement) {\n      panController = domController(domElement, options);\n    }\n  }\n\n  if (!panController) {\n    throw new Error(\n      'Cannot create panzoom for the current type of dom element'\n    );\n  }\n  var owner = panController.getOwner();\n  // just to avoid GC pressure, every time we do intermediate transform\n  // we return this object. For internal use only. Never give it back to the consumer of this library\n  var storedCTMResult = { x: 0, y: 0 };\n\n  var isDirty = false;\n  var transform$$1 = new transform();\n\n  if (panController.initTransform) {\n    panController.initTransform(transform$$1);\n  }\n\n  var filterKey = typeof options.filterKey === 'function' ? options.filterKey : noop;\n  // TODO: likely need to unite pinchSpeed with zoomSpeed\n  var pinchSpeed = typeof options.pinchSpeed === 'number' ? options.pinchSpeed : 1;\n  var bounds = options.bounds;\n  var maxZoom = typeof options.maxZoom === 'number' ? options.maxZoom : Number.POSITIVE_INFINITY;\n  var minZoom = typeof options.minZoom === 'number' ? options.minZoom : 0;\n\n  var boundsPadding = typeof options.boundsPadding === 'number' ? options.boundsPadding : 0.05;\n  var zoomDoubleClickSpeed = typeof options.zoomDoubleClickSpeed === 'number' ? options.zoomDoubleClickSpeed : defaultDoubleTapZoomSpeed;\n  var beforeWheel = options.beforeWheel || noop;\n  var beforeMouseDown = options.beforeMouseDown || noop;\n  var speed = typeof options.zoomSpeed === 'number' ? options.zoomSpeed : defaultZoomSpeed;\n  var transformOrigin = parseTransformOrigin(options.transformOrigin);\n  var textSelection = options.enableTextSelection ? fakeTextSelectorInterceptor : domTextSelectionInterceptor;\n\n  validateBounds(bounds);\n\n  if (options.autocenter) {\n    autocenter();\n  }\n\n  var frameAnimation;\n  var lastTouchEndTime = 0;\n  var touchInProgress = false;\n\n  // We only need to fire panstart when actual move happens\n  var panstartFired = false;\n\n  // cache mouse coordinates here\n  var mouseX;\n  var mouseY;\n\n  var pinchZoomLength;\n\n  var smoothScroll;\n  if ('smoothScroll' in options && !options.smoothScroll) {\n    // If user explicitly asked us not to use smooth scrolling, we obey\n    smoothScroll = rigidScroll();\n  } else {\n    // otherwise we use forward smoothScroll settings to kinetic API\n    // which makes scroll smoothing.\n    smoothScroll = kinetic_1(getPoint, scroll, options.smoothScroll);\n  }\n\n  var moveByAnimation;\n  var zoomToAnimation;\n\n  var multiTouch;\n  var paused = false;\n\n  listenForEvents();\n\n  var api = {\n    dispose: dispose,\n    moveBy: internalMoveBy,\n    moveTo: moveTo,\n    centerOn: centerOn,\n    zoomTo: publicZoomTo,\n    zoomAbs: zoomAbs,\n    smoothZoom: smoothZoom,\n    smoothZoomAbs: smoothZoomAbs,\n    showRectangle: showRectangle,\n\n    pause: pause,\n    resume: resume,\n    isPaused: isPaused,\n\n    getTransform: getTransformModel,\n    getMinZoom: getMinZoom,\n    getMaxZoom: getMaxZoom,\n\n    getTransformOrigin: getTransformOrigin,\n    setTransformOrigin: setTransformOrigin,\n\n    getZoomSpeed: getZoomSpeed,\n    setZoomSpeed: setZoomSpeed\n  };\n\n  ngraph_events$1(api);\n\n  return api;\n\n  function pause() {\n    releaseEvents();\n    paused = true;\n  }\n\n  function resume() {\n    if (paused) {\n      listenForEvents();\n      paused = false;\n    }\n  }\n\n  function isPaused() {\n    return paused;\n  }\n\n  function showRectangle(rect) {\n    // TODO: this duplicates autocenter. I think autocenter should go.\n    var clientRect = owner.getBoundingClientRect();\n    var size = transformToScreen(clientRect.width, clientRect.height);\n\n    var rectWidth = rect.right - rect.left;\n    var rectHeight = rect.bottom - rect.top;\n    if (!Number.isFinite(rectWidth) || !Number.isFinite(rectHeight)) {\n      throw new Error('Invalid rectangle');\n    }\n\n    var dw = size.x / rectWidth;\n    var dh = size.y / rectHeight;\n    var scale = Math.min(dw, dh);\n    transform$$1.x = -(rect.left + rectWidth / 2) * scale + size.x / 2;\n    transform$$1.y = -(rect.top + rectHeight / 2) * scale + size.y / 2;\n    transform$$1.scale = scale;\n  }\n\n  function transformToScreen(x, y) {\n    if (panController.getScreenCTM) {\n      var parentCTM = panController.getScreenCTM();\n      var parentScaleX = parentCTM.a;\n      var parentScaleY = parentCTM.d;\n      var parentOffsetX = parentCTM.e;\n      var parentOffsetY = parentCTM.f;\n      storedCTMResult.x = x * parentScaleX - parentOffsetX;\n      storedCTMResult.y = y * parentScaleY - parentOffsetY;\n    } else {\n      storedCTMResult.x = x;\n      storedCTMResult.y = y;\n    }\n\n    return storedCTMResult;\n  }\n\n  function autocenter() {\n    var w; // width of the parent\n    var h; // height of the parent\n    var left = 0;\n    var top = 0;\n    var sceneBoundingBox = getBoundingBox();\n    if (sceneBoundingBox) {\n      // If we have bounding box - use it.\n      left = sceneBoundingBox.left;\n      top = sceneBoundingBox.top;\n      w = sceneBoundingBox.right - sceneBoundingBox.left;\n      h = sceneBoundingBox.bottom - sceneBoundingBox.top;\n    } else {\n      // otherwise just use whatever space we have\n      var ownerRect = owner.getBoundingClientRect();\n      w = ownerRect.width;\n      h = ownerRect.height;\n    }\n    var bbox = panController.getBBox();\n    if (bbox.width === 0 || bbox.height === 0) {\n      // we probably do not have any elements in the SVG\n      // just bail out;\n      return;\n    }\n    var dh = h / bbox.height;\n    var dw = w / bbox.width;\n    var scale = Math.min(dw, dh);\n    transform$$1.x = -(bbox.left + bbox.width / 2) * scale + w / 2 + left;\n    transform$$1.y = -(bbox.top + bbox.height / 2) * scale + h / 2 + top;\n    transform$$1.scale = scale;\n  }\n\n  function getTransformModel() {\n    // TODO: should this be read only?\n    return transform$$1;\n  }\n\n  function getMinZoom() {\n    return minZoom;\n  }\n\n  function getMaxZoom() {\n    return maxZoom;\n  }\n\n  function getTransformOrigin() {\n    return transformOrigin;\n  }\n\n  function setTransformOrigin(newTransformOrigin) {\n    transformOrigin = parseTransformOrigin(newTransformOrigin);\n  }\n\n  function getZoomSpeed() {\n    return speed;\n  }\n\n  function setZoomSpeed(newSpeed) {\n    if (!Number.isFinite(newSpeed)) {\n      throw new Error('Zoom speed should be a number');\n    }\n    speed = newSpeed;\n  }\n\n  function getPoint() {\n    return {\n      x: transform$$1.x,\n      y: transform$$1.y\n    };\n  }\n\n  function moveTo(x, y) {\n    transform$$1.x = x;\n    transform$$1.y = y;\n\n    keepTransformInsideBounds();\n\n    triggerEvent('pan');\n    makeDirty();\n  }\n\n  function moveBy(dx, dy) {\n    moveTo(transform$$1.x + dx, transform$$1.y + dy);\n  }\n\n  function keepTransformInsideBounds() {\n    var boundingBox = getBoundingBox();\n    if (!boundingBox) { return; }\n\n    var adjusted = false;\n    var clientRect = getClientRect();\n\n    var diff = boundingBox.left - clientRect.right;\n    if (diff > 0) {\n      transform$$1.x += diff;\n      adjusted = true;\n    }\n    // check the other side:\n    diff = boundingBox.right - clientRect.left;\n    if (diff < 0) {\n      transform$$1.x += diff;\n      adjusted = true;\n    }\n\n    // y axis:\n    diff = boundingBox.top - clientRect.bottom;\n    if (diff > 0) {\n      // we adjust transform, so that it matches exactly our bounding box:\n      // transform.y = boundingBox.top - (boundingBox.height + boundingBox.y) * transform.scale =>\n      // transform.y = boundingBox.top - (clientRect.bottom - transform.y) =>\n      // transform.y = diff + transform.y =>\n      transform$$1.y += diff;\n      adjusted = true;\n    }\n\n    diff = boundingBox.bottom - clientRect.top;\n    if (diff < 0) {\n      transform$$1.y += diff;\n      adjusted = true;\n    }\n    return adjusted;\n  }\n\n  /**\n   * Returns bounding box that should be used to restrict scene movement.\n   */\n  function getBoundingBox() {\n    if (!bounds) { return; } // client does not want to restrict movement\n\n    if (typeof bounds === 'boolean') {\n      // for boolean type we use parent container bounds\n      var ownerRect = owner.getBoundingClientRect();\n      var sceneWidth = ownerRect.width;\n      var sceneHeight = ownerRect.height;\n\n      return {\n        left: sceneWidth * boundsPadding,\n        top: sceneHeight * boundsPadding,\n        right: sceneWidth * (1 - boundsPadding),\n        bottom: sceneHeight * (1 - boundsPadding)\n      };\n    }\n\n    return bounds;\n  }\n\n  function getClientRect() {\n    var bbox = panController.getBBox();\n    var leftTop = client(bbox.left, bbox.top);\n\n    return {\n      left: leftTop.x,\n      top: leftTop.y,\n      right: bbox.width * transform$$1.scale + leftTop.x,\n      bottom: bbox.height * transform$$1.scale + leftTop.y\n    };\n  }\n\n  function client(x, y) {\n    return {\n      x: x * transform$$1.scale + transform$$1.x,\n      y: y * transform$$1.scale + transform$$1.y\n    };\n  }\n\n  function makeDirty() {\n    isDirty = true;\n    frameAnimation = window.requestAnimationFrame(frame);\n  }\n\n  function zoomByRatio(clientX, clientY, ratio) {\n    if (isNaN(clientX) || isNaN(clientY) || isNaN(ratio)) {\n      throw new Error('zoom requires valid numbers');\n    }\n\n    var newScale = transform$$1.scale * ratio;\n\n    if (newScale < minZoom) {\n      if (transform$$1.scale === minZoom) { return; }\n\n      ratio = minZoom / transform$$1.scale;\n    }\n    if (newScale > maxZoom) {\n      if (transform$$1.scale === maxZoom) { return; }\n\n      ratio = maxZoom / transform$$1.scale;\n    }\n\n    var size = transformToScreen(clientX, clientY);\n\n    transform$$1.x = size.x - ratio * (size.x - transform$$1.x);\n    transform$$1.y = size.y - ratio * (size.y - transform$$1.y);\n\n    // TODO: https://github.com/anvaka/panzoom/issues/112\n    if (bounds && boundsPadding === 1 && minZoom === 1) {\n      transform$$1.scale *= ratio;\n      keepTransformInsideBounds();\n    } else {\n      var transformAdjusted = keepTransformInsideBounds();\n      if (!transformAdjusted) { transform$$1.scale *= ratio; }\n    }\n\n    triggerEvent('zoom');\n\n    makeDirty();\n  }\n\n  function zoomAbs(clientX, clientY, zoomLevel) {\n    var ratio = zoomLevel / transform$$1.scale;\n    zoomByRatio(clientX, clientY, ratio);\n  }\n\n  function centerOn(ui) {\n    var parent = ui.ownerSVGElement;\n    if (!parent)\n      { throw new Error('ui element is required to be within the scene'); }\n\n    // TODO: should i use controller's screen CTM?\n    var clientRect = ui.getBoundingClientRect();\n    var cx = clientRect.left + clientRect.width / 2;\n    var cy = clientRect.top + clientRect.height / 2;\n\n    var container = parent.getBoundingClientRect();\n    var dx = container.width / 2 - cx;\n    var dy = container.height / 2 - cy;\n\n    internalMoveBy(dx, dy, true);\n  }\n\n  function internalMoveBy(dx, dy, smooth) {\n    if (!smooth) {\n      return moveBy(dx, dy);\n    }\n\n    if (moveByAnimation) { moveByAnimation.cancel(); }\n\n    var from = { x: 0, y: 0 };\n    var to = { x: dx, y: dy };\n    var lastX = 0;\n    var lastY = 0;\n\n    moveByAnimation = amator(from, to, {\n      step: function(v) {\n        moveBy(v.x - lastX, v.y - lastY);\n\n        lastX = v.x;\n        lastY = v.y;\n      }\n    });\n  }\n\n  function scroll(x, y) {\n    cancelZoomAnimation();\n    moveTo(x, y);\n  }\n\n  function dispose() {\n    releaseEvents();\n  }\n\n  function listenForEvents() {\n    owner.addEventListener('mousedown', onMouseDown, {passive: false});\n    owner.addEventListener('dblclick', onDoubleClick, {passive: false});\n    owner.addEventListener('touchstart', onTouch, {passive: false});\n    owner.addEventListener('keydown', onKeyDown, {passive: false});\n\n    // Need to listen on the owner container, so that we are not limited\n    // by the size of the scrollable domElement\n    wheel.addWheelListener(owner, onMouseWheel, {passive: false});\n\n    makeDirty();\n  }\n\n  function releaseEvents() {\n    wheel.removeWheelListener(owner, onMouseWheel);\n    owner.removeEventListener('mousedown', onMouseDown);\n    owner.removeEventListener('keydown', onKeyDown);\n    owner.removeEventListener('dblclick', onDoubleClick);\n    owner.removeEventListener('touchstart', onTouch);\n\n    if (frameAnimation) {\n      window.cancelAnimationFrame(frameAnimation);\n      frameAnimation = 0;\n    }\n\n    smoothScroll.cancel();\n\n    releaseDocumentMouse();\n    releaseTouches();\n    textSelection.release();\n\n    triggerPanEnd();\n  }\n\n  function frame() {\n    if (isDirty) { applyTransform(); }\n  }\n\n  function applyTransform() {\n    isDirty = false;\n\n    // TODO: Should I allow to cancel this?\n    panController.applyTransform(transform$$1);\n\n    triggerEvent('transform');\n    frameAnimation = 0;\n  }\n\n  function onKeyDown(e) {\n    var x = 0,\n      y = 0,\n      z = 0;\n    if (e.keyCode === 38) {\n      y = 1; // up\n    } else if (e.keyCode === 40) {\n      y = -1; // down\n    } else if (e.keyCode === 37) {\n      x = 1; // left\n    } else if (e.keyCode === 39) {\n      x = -1; // right\n    } else if (e.keyCode === 189 || e.keyCode === 109) {\n      // DASH or SUBTRACT\n      z = 1; // `-` -  zoom out\n    } else if (e.keyCode === 187 || e.keyCode === 107) {\n      // EQUAL SIGN or ADD\n      z = -1; // `=` - zoom in (equal sign on US layout is under `+`)\n    }\n\n    if (filterKey(e, x, y, z)) {\n      // They don't want us to handle the key: https://github.com/anvaka/panzoom/issues/45\n      return;\n    }\n\n    if (x || y) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      var clientRect = owner.getBoundingClientRect();\n      // movement speed should be the same in both X and Y direction:\n      var offset = Math.min(clientRect.width, clientRect.height);\n      var moveSpeedRatio = 0.05;\n      var dx = offset * moveSpeedRatio * x;\n      var dy = offset * moveSpeedRatio * y;\n\n      // TODO: currently we do not animate this. It could be better to have animation\n      internalMoveBy(dx, dy);\n    }\n\n    if (z) {\n      var scaleMultiplier = getScaleMultiplier(z * 100);\n      var offset = transformOrigin ? getTransformOriginOffset() : midPoint();\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n    }\n  }\n\n  function midPoint() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width / 2,\n      y: ownerRect.height / 2\n    };\n  }\n\n  function onTouch(e) {\n    // let the override the touch behavior\n    beforeTouch(e);\n\n    if (e.touches.length === 1) {\n      return handleSingleFingerTouch(e, e.touches[0]);\n    } else if (e.touches.length === 2) {\n      // handleTouchMove() will care about pinch zoom.\n      pinchZoomLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n      multiTouch = true;\n      startTouchListenerIfNeeded();\n    }\n  }\n\n  function beforeTouch(e) {\n    // TODO: Need to unify this filtering names. E.g. use `beforeTouch`\n    if (options.onTouch && !options.onTouch(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/12\n      return;\n    }\n\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  function beforeDoubleClick(e) {\n    // TODO: Need to unify this filtering names. E.g. use `beforeDoubleClick``\n    if (options.onDoubleClick && !options.onDoubleClick(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/46\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  function handleSingleFingerTouch(e) {\n    var touch = e.touches[0];\n    var offset = getOffsetXY(touch);\n    mouseX = offset.x;\n    mouseY = offset.y;\n\n    smoothScroll.cancel();\n    startTouchListenerIfNeeded();\n  }\n\n  function startTouchListenerIfNeeded() {\n    if (touchInProgress) {\n      // no need to do anything, as we already listen to events;\n      return;\n    }\n\n    touchInProgress = true;\n    document.addEventListener('touchmove', handleTouchMove);\n    document.addEventListener('touchend', handleTouchEnd);\n    document.addEventListener('touchcancel', handleTouchEnd);\n  }\n\n  function handleTouchMove(e) {\n    if (e.touches.length === 1) {\n      e.stopPropagation();\n      var touch = e.touches[0];\n\n      var offset = getOffsetXY(touch);\n      var point = transformToScreen(offset.x, offset.y);\n\n      var dx = point.x - mouseX;\n      var dy = point.y - mouseY;\n\n      if (dx !== 0 && dy !== 0) {\n        triggerPanStart();\n      }\n      mouseX = point.x;\n      mouseY = point.y;\n      internalMoveBy(dx, dy);\n    } else if (e.touches.length === 2) {\n      // it's a zoom, let's find direction\n      multiTouch = true;\n      var t1 = e.touches[0];\n      var t2 = e.touches[1];\n      var currentPinchLength = getPinchZoomLength(t1, t2);\n\n      // since the zoom speed is always based on distance from 1, we need to apply\n      // pinch speed only on that distance from 1:\n      var scaleMultiplier =\n        1 + (currentPinchLength / pinchZoomLength - 1) * pinchSpeed;\n\n      var firstTouchPoint = getOffsetXY(t1);\n      var secondTouchPoint = getOffsetXY(t2);\n      mouseX = (firstTouchPoint.x + secondTouchPoint.x) / 2;\n      mouseY = (firstTouchPoint.y + secondTouchPoint.y) / 2;\n      if (transformOrigin) {\n        var offset = getTransformOriginOffset();\n        mouseX = offset.x;\n        mouseY = offset.y;\n      }\n\n      publicZoomTo(mouseX, mouseY, scaleMultiplier);\n\n      pinchZoomLength = currentPinchLength;\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  function handleTouchEnd(e) {\n    if (e.touches.length > 0) {\n      var offset = getOffsetXY(e.touches[0]);\n      mouseX = offset.x;\n      mouseY = offset.y;\n    } else {\n      var now = new Date();\n      if (now - lastTouchEndTime < doubleTapSpeedInMS) {\n        if (transformOrigin) {\n          var offset = getTransformOriginOffset();\n          smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n        } else {\n          smoothZoom(mouseX, mouseY, zoomDoubleClickSpeed);\n        }\n      }\n\n      lastTouchEndTime = now;\n\n      touchInProgress = false;\n      triggerPanEnd();\n      releaseTouches();\n    }\n  }\n\n  function getPinchZoomLength(finger1, finger2) {\n    var dx = finger1.clientX - finger2.clientX;\n    var dy = finger1.clientY - finger2.clientY;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  function onDoubleClick(e) {\n    beforeDoubleClick(e);\n    var offset = getOffsetXY(e);\n    if (transformOrigin) {\n      // TODO: looks like this is duplicated in the file.\n      // Need to refactor\n      offset = getTransformOriginOffset();\n    }\n    smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n  }\n\n  function onMouseDown(e) {\n    // if client does not want to handle this event - just ignore the call\n    if (beforeMouseDown(e)) { return; }\n\n    if (touchInProgress) {\n      // modern browsers will fire mousedown for touch events too\n      // we do not want this: touch is handled separately.\n      e.stopPropagation();\n      return false;\n    }\n    // for IE, left click == 1\n    // for Firefox, left click == 0\n    var isLeftButton =\n      (e.button === 1 && window.event !== null) || e.button === 0;\n    if (!isLeftButton) { return; }\n\n    smoothScroll.cancel();\n\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    mouseX = point.x;\n    mouseY = point.y;\n\n    // We need to listen on document itself, since mouse can go outside of the\n    // window, and we will loose it\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n    textSelection.capture(e.target || e.srcElement);\n\n    return false;\n  }\n\n  function onMouseMove(e) {\n    // no need to worry about mouse events when touch is happening\n    if (touchInProgress) { return; }\n\n    triggerPanStart();\n\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    var dx = point.x - mouseX;\n    var dy = point.y - mouseY;\n\n    mouseX = point.x;\n    mouseY = point.y;\n\n    internalMoveBy(dx, dy);\n  }\n\n  function onMouseUp() {\n    textSelection.release();\n    triggerPanEnd();\n    releaseDocumentMouse();\n  }\n\n  function releaseDocumentMouse() {\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n    panstartFired = false;\n  }\n\n  function releaseTouches() {\n    document.removeEventListener('touchmove', handleTouchMove);\n    document.removeEventListener('touchend', handleTouchEnd);\n    document.removeEventListener('touchcancel', handleTouchEnd);\n    panstartFired = false;\n    multiTouch = false;\n  }\n\n  function onMouseWheel(e) {\n    // if client does not want to handle this event - just ignore the call\n    if (beforeWheel(e)) { return; }\n\n    smoothScroll.cancel();\n\n    var delta = e.deltaY;\n    if (e.deltaMode > 0) { delta *= 100; }\n\n    var scaleMultiplier = getScaleMultiplier(delta);\n\n    if (scaleMultiplier !== 1) {\n      var offset = transformOrigin\n        ? getTransformOriginOffset()\n        : getOffsetXY(e);\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n      e.preventDefault();\n    }\n  }\n\n  function getOffsetXY(e) {\n    var offsetX, offsetY;\n    // I tried using e.offsetX, but that gives wrong results for svg, when user clicks on a path.\n    var ownerRect = owner.getBoundingClientRect();\n    offsetX = e.clientX - ownerRect.left;\n    offsetY = e.clientY - ownerRect.top;\n\n    return { x: offsetX, y: offsetY };\n  }\n\n  function smoothZoom(clientX, clientY, scaleMultiplier) {\n    var fromValue = transform$$1.scale;\n    var from = { scale: fromValue };\n    var to = { scale: scaleMultiplier * fromValue };\n\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n\n    zoomToAnimation = amator(from, to, {\n      step: function(v) {\n        zoomAbs(clientX, clientY, v.scale);\n      },\n      done: triggerZoomEnd\n    });\n  }\n\n  function smoothZoomAbs(clientX, clientY, toScaleValue) {\n    var fromValue = transform$$1.scale;\n    var from = { scale: fromValue };\n    var to = { scale: toScaleValue };\n\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n\n    zoomToAnimation = amator(from, to, {\n      step: function(v) {\n        zoomAbs(clientX, clientY, v.scale);\n      }\n    });\n  }\n\n  function getTransformOriginOffset() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width * transformOrigin.x,\n      y: ownerRect.height * transformOrigin.y\n    };\n  }\n\n  function publicZoomTo(clientX, clientY, scaleMultiplier) {\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n    return zoomByRatio(clientX, clientY, scaleMultiplier);\n  }\n\n  function cancelZoomAnimation() {\n    if (zoomToAnimation) {\n      zoomToAnimation.cancel();\n      zoomToAnimation = null;\n    }\n  }\n\n  function getScaleMultiplier(delta) {\n    var sign = Math.sign(delta);\n    var deltaAdjustedSpeed = Math.min(0.25, Math.abs(speed * delta/128)); \n    return 1 - sign * deltaAdjustedSpeed;\n  }\n\n  function triggerPanStart() {\n    if (!panstartFired) {\n      triggerEvent('panstart');\n      panstartFired = true;\n      smoothScroll.start();\n    }\n  }\n\n  function triggerPanEnd() {\n    if (panstartFired) {\n      // we should never run smooth scrolling if it was multiTouch (pinch zoom animation):\n      if (!multiTouch) { smoothScroll.stop(); }\n      triggerEvent('panend');\n    }\n  }\n\n  function triggerZoomEnd() {\n    triggerEvent('zoomend');\n  }\n\n  function triggerEvent(name) {\n    api.fire(name, api);\n  }\n}\n\nfunction parseTransformOrigin(options) {\n  if (!options) { return; }\n  if (typeof options === 'object') {\n    if (!isNumber(options.x) || !isNumber(options.y))\n      { failTransformOrigin(options); }\n    return options;\n  }\n\n  failTransformOrigin();\n}\n\nfunction failTransformOrigin(options) {\n  console.error(options);\n  throw new Error(\n    [\n      'Cannot parse transform origin.',\n      'Some good examples:',\n      '  \"center center\" can be achieved with {x: 0.5, y: 0.5}',\n      '  \"top center\" can be achieved with {x: 0.5, y: 0}',\n      '  \"bottom right\" can be achieved with {x: 1, y: 1}'\n    ].join('\\n')\n  );\n}\n\nfunction noop() {}\n\nfunction validateBounds(bounds) {\n  var boundsType = typeof bounds;\n  if (boundsType === 'undefined' || boundsType === 'boolean') { return; } // this is okay\n  // otherwise need to be more thorough:\n  var validBounds =\n    isNumber(bounds.left) &&\n    isNumber(bounds.top) &&\n    isNumber(bounds.bottom) &&\n    isNumber(bounds.right);\n\n  if (!validBounds)\n    { throw new Error(\n      'Bounds object is not valid. It can be: ' +\n        'undefined, boolean (true|false) or an object {left, top, right, bottom}'\n    ); }\n}\n\nfunction isNumber(x) {\n  return Number.isFinite(x);\n}\n\n// IE 11 does not support isNaN:\nfunction isNaN(value) {\n  if (Number.isNaN) {\n    return Number.isNaN(value);\n  }\n\n  return value !== value;\n}\n\nfunction rigidScroll() {\n  return {\n    start: noop,\n    stop: noop,\n    cancel: noop\n  };\n}\n\nfunction autoRun() {\n  if (typeof document === 'undefined') { return; }\n\n  var scripts = document.getElementsByTagName('script');\n  if (!scripts) { return; }\n  var panzoomScript;\n\n  for (var i = 0; i < scripts.length; ++i) {\n    var x = scripts[i];\n    if (x.src && x.src.match(/\\bpanzoom(\\.min)?\\.js/)) {\n      panzoomScript = x;\n      break;\n    }\n  }\n\n  if (!panzoomScript) { return; }\n\n  var query = panzoomScript.getAttribute('query');\n  if (!query) { return; }\n\n  var globalName = panzoomScript.getAttribute('name') || 'pz';\n  var started = Date.now();\n\n  tryAttach();\n\n  function tryAttach() {\n    var el = document.querySelector(query);\n    if (!el) {\n      var now = Date.now();\n      var elapsed = now - started;\n      if (elapsed < 2000) {\n        // Let's wait a bit\n        setTimeout(tryAttach, 100);\n        return;\n      }\n      // If we don't attach within 2 seconds to the target element, consider it a failure\n      console.error('Cannot find the panzoom element', globalName);\n      return;\n    }\n    var options = collectOptions(panzoomScript);\n    console.log(options);\n    window[globalName] = createPanZoom(el, options);\n  }\n\n  function collectOptions(script) {\n    var attrs = script.attributes;\n    var options = {};\n    for (var i = 0; i < attrs.length; ++i) {\n      var attr = attrs[i];\n      var nameValue = getPanzoomAttributeNameValue(attr);\n      if (nameValue) {\n        options[nameValue.name] = nameValue.value;\n      }\n    }\n\n    return options;\n  }\n\n  function getPanzoomAttributeNameValue(attr) {\n    if (!attr.name) { return; }\n    var isPanZoomAttribute =\n      attr.name[0] === 'p' && attr.name[1] === 'z' && attr.name[2] === '-';\n\n    if (!isPanZoomAttribute) { return; }\n\n    var name = attr.name.substr(3);\n    var value = JSON.parse(attr.value);\n    return { name: name, value: value };\n  }\n}\n\nautoRun();\n\nvar ngraph_events$3 = function eventify(subject) {\n  validateSubject$1(subject);\n\n  var eventsStorage = createEventsStorage$1(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage$1(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject$1(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n\nvar Transform$2 = function Transform(scale, dx, dy) {\n  scale = scale || 1;\n  dx = dx || 0;\n  dy = dy || 0;\n  this._array = [\n    scale, 0,0, 0,\n    0, scale,0, 0,\n    0, 0,1, 0,\n    dx, dy,0, 1\n  ];\n};\n\nvar prototypeAccessors = { scale: {},dx: {},dy: {} };\n\nTransform$2.prototype.multiply = function multiply (a, b) {\n  var scale = a.scale * b.scale;\n  var dx = a.scale * b.dx + a.dx;\n  var dy = a.scale * b.dy + a.dy;\n\n  this.scale = scale;\n  this.dx = dx;\n  this.dy = dy;\n\n  return this;\n};\n\nprototypeAccessors.scale.get = function () {\n  return this._array[0];\n};\n\nprototypeAccessors.dx.get = function () {\n  return this._array[12];\n};\n\nprototypeAccessors.dy.get = function () {\n  return this._array[13];\n};\n\nprototypeAccessors.dx.set = function (newDx) {\n  this._array[12] = newDx;\n};\n  \nprototypeAccessors.dy.set = function (newDy) {\n  this._array[13] = newDy;\n};\n\nprototypeAccessors.scale.set = function (newScale) {\n  this._array[0] = newScale;\n  this._array[5] = newScale;\n};\n\nTransform$2.prototype.copyTo = function copyTo (dst) {\n  copyArray(this._array, dst._array);\n  return this;\n};\n\nTransform$2.prototype.getArray = function getArray () {\n  return this._array;\n};\n\nObject.defineProperties( Transform$2.prototype, prototypeAccessors );\n\nfunction copyArray(from, to) {\n  if (from.length !== to.length) {\n    throw new Error('Array length mismatch');\n  }\n\n  for(var i = 0; i < from.length; ++i) {\n    to[i] = from[i];\n  }\n}\n\n/**\n * represents a single element in the scene tree\n */\nvar Element = function Element() {\n  this.children = [];\n  this.transform = new Transform$2();\n\n  // Stores transformation to the \"world\" coordinates. If this element has\n  // no parent, this object is equal to `this.transform`\n  this.worldTransform = new Transform$2();\n  this.worldTransformNeedsUpdate = true;\n  this.type = 'Element';\n  this.scene = null;\n};\n\nElement.prototype.appendChild = function appendChild (child, sendToBack) {\n  child.parent = this;\n  if (sendToBack) {\n    // back of z-index\n    this.children.unshift(child);\n  } else {\n    this.children.push(child);\n  }\n  if (child.bindScene) {\n    child.bindScene(this.scene);\n  }\n\n  if (this.scene) { this.scene.renderFrame(); }\n};\n\nElement.prototype.bindScene = function bindScene (scene) {\n  this.scene = scene;\n};\n\nElement.prototype.traverse = function traverse (enterCallback, exitCallback) {\n    var this$1 = this;\n\n  enterCallback(this);\n\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i];\n    child.traverse(enterCallback, exitCallback);\n  }\n\n  if (exitCallback) { exitCallback(this); }\n};\n\nElement.prototype.removeChild = function removeChild (child) {\n  // TODO: should this be faster?\n  var childIdx = this.children.indexOf(child);\n  if (childIdx > -1) {\n    this.children.splice(childIdx, 1);\n  }\n\n  if (this.scene) { this.scene.renderFrame(); }\n};\n\nElement.prototype.updateWorldTransform = function updateWorldTransform (force) {\n  if (this.worldTransformNeedsUpdate || force) {\n    if (!this.parent) {\n      this.transform.copyTo(this.worldTransform);\n    } else {\n      this.worldTransform.multiply(this.parent.worldTransform, this.transform);\n    }\n\n    this.worldTransformNeedsUpdate = false;\n    force = true; // We have to update children now.\n  }\n\n  var wasDirty = force;\n\n  var children = this.children;\n  for (var i = 0; i < children.length; i++ ) {\n     wasDirty = children[i].updateWorldTransform(force) || wasDirty;\n  }\n\n  return wasDirty;\n};\n\nElement.prototype.draw = function draw (gl, screen) {\n    var this$1 = this;\n\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i];\n    child.draw(gl, screen);\n  }\n};\n\nElement.prototype.dispose = function dispose () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i];\n    child.dispose();\n  }\n};\n\nvar config = {\n  maxSingleTouchTime: 300, // ms\n  singleTapDistanceSquared: 25 // within 5px we consider it as a single tap\n};\n\nfunction onClap$1(element, callback, ctx) {\n  var touchStartTime = new Date();\n  var startPos;\n\n  element.addEventListener('click', invokeHandler);\n\n  element.addEventListener('touchend', handleTouchEnd);\n  element.addEventListener('touchstart', handleTouchStart);\n\n  return disposePrevHandler;\n\n  function handleTouchStart(e) {\n    var touches = e.touches;\n\n    if (touches.length === 1) {\n      touchStartTime = new Date();\n      startPos = {\n        x: e.touches[0].pageX,\n        y: e.touches[0].pageY\n      };\n    }\n  }\n\n  function handleTouchEnd(e) {\n    // multitouch - ignore\n    if (e.touches.length > 1) { return }\n\n    // single touch - use time difference to determine if it was a touch or\n    // a swipe\n    var dt = new Date() - touchStartTime;\n\n    // To long - ignore\n    if (dt > config.maxSingleTouchTime) { return }\n    var touch = e.changedTouches[0];\n\n    var dx = touch.pageX - startPos.x;\n    var dy = touch.pageY - startPos.y;\n\n    if (dx * dx + dy * dy < config.singleTapDistanceSquared) {\n      invokeHandler(touch);\n    }\n  }\n\n  function disposePrevHandler() {\n    element.removeEventListener('click', invokeHandler);\n    element.removeEventListener('touchend', handleTouchEnd);\n    element.removeEventListener('touchstart', handleTouchStart);\n  }\n\n  function invokeHandler(e) {\n    callback.call(ctx, e);\n  }\n}\n\nfunction makeScene$1(canvas, options) {\n  var width;\n  var height;\n  var drawContext = { width: 0, height: 0 };\n  var pixelRatio = window.devicePixelRatio;\n  if (!options) { options = {}; }\n\n  var wglContextOptions = options.wglContext;\n\n  var gl = canvas.getContext('webgl', wglContextOptions) || canvas.getContext('experimental-webgl', wglContextOptions);\n\n  gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n  gl.enable(gl.BLEND);\n  gl.clearColor(0, 0, 0, 1.0);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n\n  var frameToken = 0;\n  var sceneRoot = new Element();\n  updateCanvasSize();\n\n  var api = ngraph_events$3({\n    appendChild: appendChild,\n    getSceneCoordinate: getSceneCoordinate,\n    getClientCoordinate: getClientCoordinate,\n    getTransform: getTransform,\n    getRoot: getRoot,\n    removeChild: removeChild,\n    setViewBox: setViewBox,\n    setClearColor: setClearColor,\n    clear: clear,\n    dispose: dispose,\n    renderFrame: renderFrame,\n\n    getPixelRatio: getPixelRatio,\n    setPixelRatio: setPixelRatio,\n\n    getPanzoom: getPanzoom\n  });\n\n  var wglController = wglPanZoom(canvas, sceneRoot, api);\n  canvas.style.outline = 'none';\n  canvas.setAttribute('tabindex', 0);\n\n  var panzoom$$1 = panzoom(canvas, {\n    controller: wglController\n  });\n\n  sceneRoot.bindScene(api);\n\n  var disposeClick;\n  listenToEvents();\n\n  renderFrame();\n\n  return api;\n\n  function getPixelRatio() {\n    return pixelRatio;\n  }\n\n  function setPixelRatio(newPixelRatio) {\n    pixelRatio = newPixelRatio;\n    updateCanvasSize();\n  }\n\n  function getRoot() {\n    return sceneRoot;\n  }\n\n  function getPanzoom() {\n    return panzoom$$1;\n  }\n\n  function getTransform() {\n    return sceneRoot.transform;\n  }\n\n  function setClearColor(r, g, b, a) {\n    gl.clearColor(r, g, b, a);\n  }\n\n  function listenToEvents() {\n    canvas.addEventListener('mousemove', onMouseMove);\n\n    panzoom$$1.on('transform', onTransform);\n\n    disposeClick = onClap$1(canvas, onMouseClick, this);\n\n    window.addEventListener('resize', onResize, true);\n  }\n\n  function dispose() {\n    canvas.removeEventListener('mousemove', onMouseMove);\n\n    panzoom$$1.off('transform', onTransform);\n\n    if (disposeClick) { disposeClick(); }\n\n    window.removeEventListener('resize', onResize, true);\n\n    panzoom$$1.dispose();\n    sceneRoot.dispose();\n\n    if (frameToken) {\n      cancelAnimationFrame(frameToken);\n      frameToken = 0;\n    }\n  }\n\n  function onResize() {\n    updateCanvasSize();\n  }\n\n  function updateCanvasSize() {\n    if (options.size) {\n      // Fixed size canvas doesn't update. We assume CSS does the scaling.\n      width = canvas.width = options.size.width;\n      height = canvas.height = options.size.height;\n    } else {\n      width = canvas.width = canvas.offsetWidth * pixelRatio;\n      height = canvas.height = canvas.offsetHeight * pixelRatio;\n    }\n\n    gl.viewport(0, 0, width, height);\n\n    drawContext.width = width;\n    drawContext.height = height;\n    sceneRoot.worldTransformNeedsUpdate = true;\n    renderFrame();\n  }\n\n  function onTransform(e) {\n    api.fire('transform', e);\n  }\n\n  function onMouseClick(e) {\n    var p = getSceneCoordinate(e.clientX, e.clientY);\n    api.fire('click', {\n      originalEvent: e,\n      sceneX: p.x,\n      sceneY: p.y,\n    });\n  }\n\n  function onMouseMove(e) {\n    var p = getSceneCoordinate(e.clientX, e.clientY);\n    api.fire('mousemove', {\n      originalEvent: e,\n      sceneX: p.x,\n      sceneY: p.y,\n    });\n  }\n\n  function getSceneCoordinate(clientX, clientY) {\n    var t = sceneRoot.transform;\n    var canvasX = clientX * pixelRatio;\n    var canvasY = clientY * pixelRatio;\n    var x = (canvasX - t.dx)/t.scale;\n    var y = (canvasY - t.dy)/t.scale;\n\n    return {x: x, y: y};\n  }\n\n  function getClientCoordinate(sceneX, sceneY) {\n    var t = sceneRoot.transform;\n\n    var x = (sceneX * t.scale + t.dx)/pixelRatio;\n    var y = (sceneY * t.scale + t.dy)/pixelRatio;\n\n    return {x: x, y: y};\n  }\n\n  function setViewBox(rect) {\n    panzoom$$1.showRectangle(rect, {\n      width: width,\n      height: height\n    });\n    var newT = panzoom$$1.getTransform();\n    wglController.applyTransform(newT);\n  }\n\n  function renderFrame(immediate) {\n    if (immediate) {\n      return frame();\n    }\n\n    if (!frameToken) { frameToken = requestAnimationFrame(frame); }\n  }\n\n  function frame() {\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    drawContext.wasDirty = sceneRoot.updateWorldTransform();\n    sceneRoot.draw(gl, drawContext);\n    frameToken = 0;\n  }\n\n  function clear() {\n    gl.clear(gl.COLOR_BUFFER_BIT);\n  }\n\n  function appendChild(child, sendToBack) {\n    sceneRoot.appendChild(child, sendToBack);\n  }\n\n  function removeChild(child) {\n    sceneRoot.removeChild(child);\n  }\n\n  function wglPanZoom(canvas, sceneRoot, scene) {\n    var controller = {\n      applyTransform: function applyTransform(newT) {\n        var transform = sceneRoot.transform;\n        var pixelRatio = scene.getPixelRatio();\n\n        transform.dx = newT.x * pixelRatio;\n        transform.dy = newT.y * pixelRatio;\n        transform.scale = newT.scale;\n        sceneRoot.worldTransformNeedsUpdate = true;\n        scene.renderFrame();\n      },\n\n      getOwner: function getOwner() {\n        return canvas\n      }\n    };\n\n    if (options.size){\n      controller.getScreenCTM = customSizeCTM;\n    }\n\n    return controller;\n\n    function customSizeCTM() {\n        return {\n          a: (options.size.width/canvas.offsetWidth), //scale x\n          d: (options.size.height/canvas.offsetHeight), //scale y\n          e: 0,\n          f: 0\n        }\n      }\n  }\n}\n\nvar glUtils = {\n  compile: compile,\n  link: link,\n  getLocations: getLocations,\n  getAttributes: getAttributes,\n  getUniforms: getUniforms,\n  initBuffer: initBuffer\n};\n\nfunction compile(gl, type, shaderSrc) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, shaderSrc);\n  gl.compileShader(shader);\n\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    throw new Error(gl.getShaderInfoLog(shader));\n  }\n\n  return shader;\n}\n\nfunction link(gl, vertexShader, fragmentShader) {\n  var program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n\n  gl.linkProgram(program);\n\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    throw new Error(gl.getProgramInfoLog(program));\n  }\n\n  return program;\n}\n\nfunction getLocations(gl, program) {\n  return {\n    attributes: getAttributes(gl, program),\n    uniforms: getUniforms(gl, program)\n  }\n}\n\nfunction getAttributes(gl, program) {\n  var attributes = Object.create(null);\n\n  var numberOfAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n  for (var i = 0; i < numberOfAttributes; ++i) {\n    var name = gl.getActiveAttrib(program, i).name;\n    attributes[name] = gl.getAttribLocation(program, name);\n  }\n\n  return attributes;\n}\n\nfunction getUniforms(gl, program) {\n  var uniforms = Object.create(null);\n  var numberOfUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n  for (var i = 0; i < numberOfUniforms; ++i) {\n    var name = gl.getActiveUniform(program, i).name;\n    uniforms[name] = gl.getUniformLocation(program, name);\n  }\n\n  return uniforms;\n}\n\nfunction initBuffer(gl, data, elementsPerVertex, attribute) {\n  var buffer = gl.createBuffer();\n  if (!buffer) { throw new Error('Failed to create a buffer'); }\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n  gl.vertexAttribPointer(attribute, elementsPerVertex, gl.FLOAT, false, 0, 0);\n  gl.enableVertexAttribArray(attribute);\n}\n\nvar shaderGraph = {\n  /**\n   * Gets vertex shader code from a given array of shader graph nodes.\n   */\n  getVSCode: getVSCode\n};\n\nfunction getVSCode(nodes) {\n  // We just generate shader code in multiple passes.\n  var code = []; \n  nodes.forEach(function (node) {\n    if (node.globals) { code.push(node.globals()); }\n  });\n  code.push('void main() {');\n  nodes.forEach(function (node) {\n    if (node.mainBody) { code.push(node.mainBody()); }\n  });\n  code.push('}');\n\n  return code.join('\\n');\n}\n\nvar panzoomVS = {\n  globals: function globals() {\n    return \"\\nattribute vec2 aPosition;\\nuniform vec2 uScreenSize;\\nuniform mat4 uTransform;\\n\";\n  },\n  mainBody: function mainBody() {\n    return \"\\n  mat4 transformed = mat4(uTransform);\\n\\n  // Translate screen coordinates to webgl space\\n  vec2 vv = 2.0 * uTransform[3].xy/uScreenSize;\\n  transformed[3][0] = vv.x - 1.0;\\n  transformed[3][1] = 1.0 - vv.y;\\n  vec2 xy = 2.0 * aPosition/uScreenSize;\\n  gl_Position = transformed * vec4(xy.x, -xy.y, 0.0, 1.0);\\n\"\n  }\n};\n\nvar pointVS = {\n  globals: function globals() {\n    return \"\\nattribute float aPointSize;\\nattribute vec4 aColor;\\nvarying vec4 vColor;\\n\";\n  },\n  mainBody: function mainBody() {\n    return \"\\n  gl_PointSize = aPointSize * transformed[0][0];\\n  vColor = aColor;\\n\";\n  }\n};\n\nvar vertexShaderSrc = shaderGraph.getVSCode([\n  panzoomVS,\n  pointVS\n]);\n\nvar fragmentShaderSrc = \"\\nprecision highp float;\\nvarying vec4 vColor;\\nuniform sampler2D texture;\\n\\nvoid main() {\\n  vec4 tColor = texture2D( texture, gl_PointCoord );\\n  gl_FragColor = vec4(vColor.rgb, tColor.a);\\n  //gl_FragColor = vec4(vColor.rgb, 1.0);\\n  // vec2 t = 2.0 * gl_PointCoord - 1.0;\\n  // float a = 1.0 - pow(t.x, 2.0) - pow(t.y, 2.0);\\n  // gl_FragColor = vec4(vColor.rgb, a);\\n}\\n\";\n\nvar vertexProgramCache = new Map(); // maps from GL context to program\n\nfunction makePointsProgram$1(gl, data) {\n  var vertexProgram = vertexProgramCache.get(gl);\n  if (!vertexProgram) {\n    var vertexShader = glUtils.compile(gl, gl.VERTEX_SHADER, vertexShaderSrc);\n    var fragmentShader = glUtils.compile(gl, gl.FRAGMENT_SHADER, fragmentShaderSrc);\n    vertexProgram = glUtils.link(gl, vertexShader, fragmentShader);\n    vertexProgramCache.set(gl, vertexProgram);\n  }\n\n  var locations = glUtils.getLocations(gl, vertexProgram);\n\n  var buffer = gl.createBuffer();\n  if (!buffer) { throw new Error('failed to create a nodesBuffer'); }\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, data.byteLength, gl.DYNAMIC_DRAW);\n\n  var pointTexture = createCircleTexture(gl);\n\n  var api = {\n    draw: draw,\n    updateData: updateData,\n    dispose: dispose\n  };\n  return api;\n\n  function updateData(newData) {\n    data = newData;\n  }\n\n  function dispose() {\n    // For some reason disposing the buffer results in unbindable\n    // buffer for the lines program (that is created after this scene is disposed).\n    // gl.deleteBuffer(buffer);\n    gl.deleteProgram(vertexProgram);\n    gl.deleteTexture(pointTexture);\n    vertexProgramCache.delete(gl);\n  }\n\n  function draw(transform, screen, count) {\n    gl.useProgram(vertexProgram);\n\n    var bpe = data.BYTES_PER_ELEMENT;\n\n    if (transform) {\n      gl.uniformMatrix4fv(locations.uniforms.uTransform, false, transform.getArray());\n    }\n    gl.uniform2f(locations.uniforms.uScreenSize, screen.width, screen.height);\n    gl.bindTexture(gl.TEXTURE_2D, pointTexture);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, data, gl.DYNAMIC_DRAW);\n\n    gl.vertexAttribPointer(locations.attributes.aPosition, 2, gl.FLOAT, false, bpe * 6, 0);\n    gl.enableVertexAttribArray(locations.attributes.aPosition);\n\n    gl.vertexAttribPointer(locations.attributes.aPointSize, 1, gl.FLOAT, false, bpe * 6, 2 * bpe);\n    gl.enableVertexAttribArray(locations.attributes.aPointSize);\n\n    gl.vertexAttribPointer(locations.attributes.aColor, 3, gl.FLOAT, false, bpe * 6, 3 * bpe);\n    gl.enableVertexAttribArray(locations.attributes.aColor);\n    gl.drawArrays(gl.POINTS, 0, count);\n  }\n}\n\nfunction createCircleTexture(gl) {\n  var pointTexture = gl.createTexture();\n  if (!pointTexture) { throw new Error('Failed to create circle texture'); }\n  gl.bindTexture(gl.TEXTURE_2D, pointTexture);\n\n  var size = 64;\n  var image = circle(size);\n\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, size, size, 0, gl.RGBA, gl.UNSIGNED_BYTE, image);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.generateMipmap(gl.TEXTURE_2D);\n\n  return pointTexture;\n\n  function circle(size) {\n    var result = new Uint8Array(size * size * 4);\n    var r = (size - 8)/2;\n    for (var row = 0; row < size; ++row) {\n      var offset = row * size;\n      for (var col = 0; col < size; ++col) {\n        var rgbaCoord = (offset + col) * 4;\n        var cy = row - r;\n        var cx = col - r;\n        var distToCenter = Math.sqrt(cx * cx + cy * cy);\n        if (distToCenter < r) {\n          var ratio = (1 - distToCenter/r);\n          result[rgbaCoord + 3] = ratio > 0.3 ? 0xff : 0xff * ratio;\n        } else {\n          result[rgbaCoord + 3] = 0x00;\n        }\n      }\n    }\n    return blur(result, size)\n\n    //return result\n  }\n}\n\nfunction blur(src, size) {\n  var result = new Uint8Array(size * size * 4);\n  for (var row = 0; row < size; ++row) {\n    for (var col = 0; col < size; ++col) {\n      result[(row * size + col) * 4 + 3] = sample(row, col, 3, src, size);\n    }\n  }\n\n  return result;\n\n}\nfunction sample(row, col, depth, src, size) {\n  var avg = 0;\n  var count = 0;\n  for (var y = row - depth; y < row + depth; ++y) {\n    if (y < 0 || y >= size) { continue; }\n    for (var x = col - depth; x < col + depth; ++x) {\n      if (x < 0 || x >= size) { continue; }\n\n      avg += src[(y * size + x) * 4 + 3];\n      count += 1;\n    }\n  }\n\n  return avg/count;\n}\n\nvar Color = function Color(r, g, b, a) {\n  this.r = r;\n  this.g = g;\n  this.b = b;\n  this.a = a === undefined ? 1 : a;\n};\n\nvar PointAccessor = function PointAccessor(buffer, offset, color, data) {\n  this.offset = offset;\n  this.buffer = buffer;\n  this.color = color || new Color(1, 1, 1, 1); \n  if (data !== undefined) {\n    this.data = data;\n  }\n};\n\nvar prototypeAccessors$1 = { x: {},y: {} };\n\nprototypeAccessors$1.x.get = function () {\n  return this.buffer[this.offset];\n};\n\nprototypeAccessors$1.y.get = function () {\n  return this.buffer[this.offset + 1];\n};\n\nPointAccessor.prototype.update = function update (point, defaults) {\n  var offset = this.offset;\n  var points = this.buffer;\n\n  points[offset + 0] = point.x;\n  points[offset + 1] = point.y;\n  if (point.size || defaults) {\n    points[offset + 2] = typeof point.size === 'number' ? point.size : defaults.size;\n  }\n\n  this.setColor(this.color);\n};\n\nPointAccessor.prototype.setColor = function setColor (color) {\n  this.color = color;\n  // TODO: This is waste, we can store rgba in 32 bits, not in the 3 * 3 * 8 bits?\n  this.buffer[this.offset + 3] = color.r;\n  this.buffer[this.offset + 4] = color.g;\n  this.buffer[this.offset + 5] = color.b;\n};\n\nObject.defineProperties( PointAccessor.prototype, prototypeAccessors$1 );\n\nvar ITEMS_PER_POINT = 6;  // x, y, size, r, g, b\n\nvar PointCollection = (function (Element$$1) {\n  function PointCollection(capacity) {\n    Element$$1.call(this);\n    this.type = 'PointCollection';\n\n    // TODO: Not sure I like this too much. But otherwise how can I track interactivity?\n    this.pointsAccessor = [];\n\n    this.capacity = capacity;\n    this.pointsBuffer = new Float32Array(capacity * ITEMS_PER_POINT);\n    this.count = 0;\n    this._program = null;\n    this.color = new Color(1, 1, 1, 1);\n    this.size = 1;\n  }\n\n  if ( Element$$1 ) PointCollection.__proto__ = Element$$1;\n  PointCollection.prototype = Object.create( Element$$1 && Element$$1.prototype );\n  PointCollection.prototype.constructor = PointCollection;\n\n  PointCollection.prototype.draw = function draw (gl, screen) {\n    if (!this._program) {\n      this._program = makePointsProgram$1(gl, this.pointsBuffer);\n    }\n\n    this._program.draw(this.worldTransform, screen, this.count);\n  };\n\n  PointCollection.prototype.dispose = function dispose () {\n    if (this._program) {\n      this._program.dispose();\n      this._program = null;\n    }\n  };\n\n  PointCollection.prototype.add = function add (point, data) {\n    if (!point) { throw new Error('Point is required'); }\n\n    if (this.count >= this.capacity)  {\n      this._extendArray();\n    }\n    var pointsBuffer = this.pointsBuffer;\n    var internalNodeId = this.count;\n    var offset = internalNodeId * ITEMS_PER_POINT;\n    var pointAccessor = new PointAccessor(pointsBuffer, offset, point.color || this.color, data);\n\n    this.pointsAccessor.push(pointAccessor);\n\n    pointAccessor.update(point, this);\n\n    this.count += 1;\n    return pointAccessor\n  };\n\n  PointCollection.prototype._extendArray = function _extendArray () {\n    // This is because we would have to track every created point accessor\n    // TODO: Whelp, a week older you thinks that we should be tracking the points\n    // for interactivity... So, might as well implement this stuff. Remember anything\n    // about premature optimization?\n    throw new Error('Cannot extend array at the moment :(')\n  };\n\n  return PointCollection;\n}(Element));\n\nvar Point = function Point(x, y, size) {\n  if (Number.isNaN(x)) { throw new Error('x is not a number'); }\n  if (Number.isNaN(y)) { throw new Error('y is not a number'); }\n\n  this.x = x;\n  this.y = y;\n  this.color = new Color(255, 255, 255);\n\n  this.size = Number.isFinite(size) ? size : 4;\n};\n\nvar BaseLineCollection = (function (Element$$1) {\n  function BaseLineCollection(capacity, itemsPerLine) {\n    Element$$1.call(this);\n\n    this.itemsPerLine = itemsPerLine;\n    this.capacity = capacity;\n    this.count = 0;\n    this._program = null;\n    this.color = new Color(1, 1, 1, 1);\n    this.buffer = new Float32Array(capacity * this.itemsPerLine);\n  }\n\n  if ( Element$$1 ) BaseLineCollection.__proto__ = Element$$1;\n  BaseLineCollection.prototype = Object.create( Element$$1 && Element$$1.prototype );\n  BaseLineCollection.prototype.constructor = BaseLineCollection;\n\n  BaseLineCollection.prototype.draw = function draw (gl, screen) {\n    if (!this._program) {\n      this._program = this._makeProgram(gl);\n    }\n    var transform = this.worldTransform;\n\n    this._program.draw(transform, this.color, screen);\n  };\n\n  BaseLineCollection.prototype._makeProgram = function _makeProgram () {\n    throw new Error('Not implemented');\n  };\n\n  BaseLineCollection.prototype._addInternal = function _addInternal () {\n    throw new Error('Not implemented');\n  };\n\n  BaseLineCollection.prototype.add = function add (line) {\n    if (!line) { throw new Error('Line is required'); }\n\n    if (this.count >= this.capacity)  {\n      this._extendArray();\n    }\n\n    var offset = this.count * this.itemsPerLine;\n    var ui = this._addInternal(line, offset);\n\n    this.count += 1;\n    return ui;\n  };\n\n  BaseLineCollection.prototype.dispose = function dispose () {\n    if (this._program) {\n      this._program.dispose();\n      this._program = null;\n    }\n  };\n\n  BaseLineCollection.prototype._extendArray = function _extendArray () {\n    // Every time we run out of space create new array twice bigger.\n    var newCapacity = this.capacity * this.itemsPerLine * 2;\n    var extendedArray = new Float32Array(newCapacity);\n    if (this.buffer) {\n      extendedArray.set(this.buffer);\n    }\n\n    this.buffer = extendedArray;\n    this.capacity = newCapacity;\n  };\n\n  return BaseLineCollection;\n}(Element));\n\nvar lineVSSrc = shaderGraph.getVSCode([\n  panzoomVS\n]);\n\nvar lineFSSrc = \"\\nprecision highp float;\\nuniform vec4 uColor;\\n\\nvoid main() {\\n  gl_FragColor = uColor;\\n}\\n\";\n\n// TODO: this needs to be in a separate file, with proper resource management\nvar lineProgramCache = new Map(); // maps from GL context to program\n\nfunction makeLineProgram$1(gl, data, drawTriangles) {\n  var lineProgram = lineProgramCache.get(gl);\n  if (!lineProgram) {\n    var lineVSShader = glUtils.compile(gl, gl.VERTEX_SHADER, lineVSSrc);\n    var lineFSShader = glUtils.compile(gl, gl.FRAGMENT_SHADER, lineFSSrc);\n    lineProgram = glUtils.link(gl, lineVSShader, lineFSShader);\n    lineProgramCache.set(gl, lineProgram);\n  }\n\n  var locations = glUtils.getLocations(gl, lineProgram);\n\n  var lineBuffer = gl.createBuffer();\n  var bpe = data.BYTES_PER_ELEMENT;\n  var drawType = drawTriangles ? gl.TRIANGLES : gl.LINES;\n  gl.bindBuffer(gl.ARRAY_BUFFER, lineBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, data.byteLength, gl.STATIC_DRAW);\n  gl.bufferSubData(gl.ARRAY_BUFFER, 0, data);\n\n  var api = {\n    draw: draw,\n    dispose: dispose\n  };\n\n  return api;\n\n  function dispose() {\n    gl.deleteBuffer(lineBuffer);\n    gl.deleteProgram(lineProgram);\n    lineProgramCache.delete(gl);\n  }\n\n  function draw(transform, color, screen) {\n    if (data.length === 0) { return; }\n\n    gl.useProgram(lineProgram);\n\n    gl.uniformMatrix4fv(locations.uniforms.uTransform, false, transform.getArray());\n    gl.uniform2f(locations.uniforms.uScreenSize, screen.width, screen.height);\n    gl.uniform4f(locations.uniforms.uColor, color.r, color.g, color.b, color.a);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, lineBuffer);\n    gl.enableVertexAttribArray(locations.attributes.aPosition);\n    // TODO: Avoid buffering, if data hasn't changed?\n    gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n    gl.vertexAttribPointer(locations.attributes.aPosition, 2, gl.FLOAT, false, bpe * 2, 0);\n\n    gl.drawArrays(drawType, 0, data.length / 2);\n  }\n}\n\nvar LineAccessor = function LineAccessor(buffer, offset) {\n  this.offset = offset;\n  this.buffer = buffer;\n  this.width = 1;\n};\n\nLineAccessor.prototype.setWidth = function setWidth (width) {\n  this.width = width;\n};\n\nLineAccessor.prototype.update = function update (from, to) {\n  var buffer = this.buffer;\n  var offset = this.offset;\n\n  var dx = to.x - from.x;\n  var dy = to.y - from.y;\n  if (dx === 0) { dx = 1e-4; }\n  if (dy === 0) { dy = 1e-4; }\n\n  var norm = Math.sqrt(dx * dx + dy * dy);\n  var u = dx/norm;\n  var v = dy/norm;\n\n  var width = this.width;\n  var uw = width * u;\n  var vw = width * v;\n  var x0 = from.x + vw;\n  var y0 = from.y - uw;\n  var x1 = to.x + vw;\n  var y1 = to.y - uw;\n  var x2 = from.x - vw;\n  var y2 = from.y + uw;\n  var x3 = to.x - vw;\n  var y3 = to.y + uw;\n\n  // Start\n  buffer[offset + 0] = x0;\n  buffer[offset + 1] = y0;\n\n  buffer[offset + 2] = x1;\n  buffer[offset + 3] = y1;\n\n  buffer[offset + 4] = x2;\n  buffer[offset + 5] = y2;\n\n  offset += 6;\n\n  // End\n  buffer[offset + 0] = x1;\n  buffer[offset + 1] = y1;\n\n  buffer[offset + 2] = x2;\n  buffer[offset + 3] = y2;\n\n  buffer[offset + 4] = x3;\n  buffer[offset + 5] = y3;\n  // buffer[offset + 0] = from.x\n  // buffer[offset + 1] = from.y\n\n  // buffer[offset + 2] = to.x\n  // buffer[offset + 3] = to.y\n};\n\n/**\n * Lines have varying thickness. That comes at extra price: Each line\n * requires additional space in buffer, as it is rendered as triangles\n */\nvar LineCollection = (function (BaseLineCollection$$1) {\n  function LineCollection(capacity) {\n    BaseLineCollection$$1.call(this, capacity, 12); // items per thick line\n    this.type = 'LineCollection';\n  }\n\n  if ( BaseLineCollection$$1 ) LineCollection.__proto__ = BaseLineCollection$$1;\n  LineCollection.prototype = Object.create( BaseLineCollection$$1 && BaseLineCollection$$1.prototype );\n  LineCollection.prototype.constructor = LineCollection;\n\n  LineCollection.prototype._makeProgram = function _makeProgram (gl) {\n    return makeLineProgram$1(gl, this.buffer, /* drawTriangles = */ true);\n  };\n\n  LineCollection.prototype._addInternal = function _addInternal (line, offset) {\n    // TODO: width\n    var lineUI = new LineAccessor(this.buffer, offset);\n    lineUI.update(line.from, line.to);\n    return lineUI;\n  };\n\n  return LineCollection;\n}(BaseLineCollection));\n\n/**\n * Wire accessor provides access to the buffer that stores wires.\n * \n * Wires are \"lines\" with 1.0 width.\n */\nvar WireAccessor = function WireAccessor(buffer, offset) {\n  this.offset = offset;\n  this.buffer = buffer;\n};\n\nWireAccessor.prototype.update = function update (from, to) {\n  var buffer = this.buffer;\n  var offset = this.offset;\n\n  buffer[offset + 0] = from.x;\n  buffer[offset + 1] = from.y;\n\n  buffer[offset + 2] = to.x;\n  buffer[offset + 3] = to.y;\n};\n\n/**\n * Unlike lines, wires do not have width, and are always 1px wide, regardless\n * of resolution.\n */\nvar WireCollection = (function (BaseLineCollection$$1) {\n  function WireCollection(capacity) {\n    BaseLineCollection$$1.call(this, capacity, 4); // items per wire\n\n    this.type = 'WireCollection';\n  }\n\n  if ( BaseLineCollection$$1 ) WireCollection.__proto__ = BaseLineCollection$$1;\n  WireCollection.prototype = Object.create( BaseLineCollection$$1 && BaseLineCollection$$1.prototype );\n  WireCollection.prototype.constructor = WireCollection;\n\n  WireCollection.prototype._makeProgram = function _makeProgram (gl) {\n    return makeLineProgram$1(gl, this.buffer, /* drawTriangles = */ false);\n  };\n\n  WireCollection.prototype._addInternal = function _addInternal (line, offset) {\n    var lineUI = new WireAccessor(this.buffer, offset);\n    lineUI.update(line.from, line.to);\n    return lineUI;\n  };\n\n  return WireCollection;\n}(BaseLineCollection));\n\nvar lineProgramCache$1 = new Map();\n\nfunction makeLineProgram$2(gl, data, allowColors) {\n  // TODO: Cache on allow colors too\n  var lineProgram = lineProgramCache$1.get(gl);\n  var itemsPerVertex = allowColors ? 3 : 2;\n  if (!lineProgram) {\n    var ref = getShadersCode(allowColors);\n    var lineFSSrc = ref.lineFSSrc;\n    var lineVSSrc = ref.lineVSSrc;\n    var lineVSShader = glUtils.compile(gl, gl.VERTEX_SHADER, lineVSSrc);\n    var lineFSShader = glUtils.compile(gl, gl.FRAGMENT_SHADER, lineFSSrc);\n    lineProgram = glUtils.link(gl, lineVSShader, lineFSShader);\n    lineProgramCache$1.set(gl, lineProgram);\n  }\n\n  var locations = glUtils.getLocations(gl, lineProgram);\n\n  var lineBuffer = gl.createBuffer();\n\n  var api = {\n    draw: draw,\n    dispose: dispose\n  };\n\n  return api;\n\n  function dispose() {\n    gl.deleteBuffer(lineBuffer);\n    gl.deleteProgram(lineProgram);\n    lineProgramCache$1.delete(gl);\n  }\n\n  function draw(transform, color, screen, startFrom, madeFullCircle) {\n    if (data.length === 0) { return; }\n\n    gl.useProgram(lineProgram);\n\n    var transformArray = transform.getArray();\n    gl.uniformMatrix4fv(locations.uniforms.uTransform, false, transformArray);\n    gl.uniform2f(locations.uniforms.uScreenSize, screen.width, screen.height);\n    gl.uniform4f(locations.uniforms.uColor, color.r, color.g, color.b, color.a);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, lineBuffer);\n    gl.enableVertexAttribArray(locations.attributes.aPosition);\n    gl.bufferData(gl.ARRAY_BUFFER, data, gl.DYNAMIC_DRAW);\n    if (allowColors) {\n      gl.vertexAttribPointer(\n        locations.attributes.aPosition,\n        2,\n        gl.FLOAT,\n        false,\n        3 * 4,\n        0\n      );\n      gl.enableVertexAttribArray(locations.attributes.aColor);\n      gl.vertexAttribPointer(\n        locations.attributes.aColor,\n        4,\n        gl.UNSIGNED_BYTE,\n        true,\n        3 * 4,\n        2 * 4\n      );\n    } else {\n      gl.vertexAttribPointer(\n        locations.attributes.aPosition,\n        2,\n        gl.FLOAT,\n        false,\n        0,\n        0\n      );\n    }\n\n    if (madeFullCircle) {\n      var elementsCount = data.byteLength / 4 / itemsPerVertex - startFrom;\n      gl.drawArrays(gl.LINE_STRIP, startFrom, elementsCount);\n      if (startFrom > 1) { gl.drawArrays(gl.LINE_STRIP, 0, startFrom - 1); }\n    } else {\n      gl.drawArrays(gl.LINE_STRIP, 1, startFrom - 1);\n    }\n  }\n}\n\nfunction getShadersCode(allowColors) {\n  var lineFSSrc = \"precision mediump float;\\nvarying vec4 vColor;\\nvoid main() {\\n  gl_FragColor = vColor;\\n}\\n\";\n  var lineVSSrc = shaderGraph.getVSCode([\n    {\n      globals: function globals() {\n        return (\"\\n  attribute vec2 aPosition;\\n  varying vec4 vColor;\\n  \" + (allowColors ? 'attribute vec4 aColor;' : '') + \"\\n  uniform vec4 uColor;\\n  uniform vec2 uScreenSize;\\n  uniform mat4 uTransform;\\n\");\n      },\n      mainBody: function mainBody() {\n        return (\"\\n  mat4 transformed = mat4(uTransform);\\n\\n  // Translate screen coordinates to webgl space\\n  vec2 vv = 2.0 * uTransform[3].xy/uScreenSize;\\n  transformed[3][0] = vv.x - 1.0;\\n  transformed[3][1] = 1.0 - vv.y;\\n  vec2 xy = 2.0 * aPosition.xy/uScreenSize;\\n  gl_Position = transformed * vec4(xy.x, -xy.y, 0.0, 1.0);\\n  vColor = \" + (allowColors ? 'aColor.abgr' : 'uColor') + \";\\n\");\n      }\n    }\n  ]);\n  return { lineVSSrc: lineVSSrc, lineFSSrc: lineFSSrc };\n}\n\nvar LineStripCollection = (function (Element$$1) {\n  function LineStripCollection(capacity, allowColors) {\n    if ( allowColors === void 0 ) allowColors = false;\n\n    Element$$1.call(this);\n\n    var bytesPerElement = 4;\n    this.drawCount = 0;\n    this.madeFullCircle = false;\n\n    this.allowColors = allowColors;\n    this.itemsPerLine = allowColors ? 2 + 1 : 2;\n    this.capacity = capacity;\n    this.nextElementIndex = 1;\n    this._program = null;\n    this.color = new Color(1, 1, 1, 1);\n    this.buffer = new ArrayBuffer((capacity + 1) * this.itemsPerLine * bytesPerElement);\n    this.positions = new Float32Array(this.buffer);\n    if (allowColors) {\n      this.colors = new Uint32Array(this.buffer);\n    }\n  }\n\n  if ( Element$$1 ) LineStripCollection.__proto__ = Element$$1;\n  LineStripCollection.prototype = Object.create( Element$$1 && Element$$1.prototype );\n  LineStripCollection.prototype.constructor = LineStripCollection;\n\n  LineStripCollection.prototype.draw = function draw (gl, screen) {\n    if (!this._program) {\n      this._program = makeLineProgram$2(gl, this.buffer, this.allowColors);\n    }\n    var transform = this.worldTransform;\n\n    this._program.draw(transform, this.color, screen, this.nextElementIndex, this.madeFullCircle);\n  };\n\n  LineStripCollection.prototype.add = function add (x, y, color) {\n    var offset = this.nextElementIndex * this.itemsPerLine;\n    var positions = this.positions;\n    positions[offset] = x;\n    positions[offset + 1] = y;\n\n    if (this.allowColors) {\n      this.colors[offset + 2] = color === undefined ? 0 : color;\n    }\n    this.nextElementIndex += 1;\n    this.drawCount += 1;\n\n    if (this.nextElementIndex > this.capacity) {\n      this.nextElementIndex = 1;\n      positions[0] = x;\n      positions[0 + 1] = y;\n      if (this.allowColors) {\n        this.colors[2] = this.colors[offset + 2];\n      }\n      this.madeFullCircle = true;\n    }\n  };\n\n  LineStripCollection.prototype.dispose = function dispose () {\n    if (this._program) {\n      this._program.dispose();\n      this._program = null;\n    }\n  };\n\n  return LineStripCollection;\n}(Element));\n\nfunction isWebGLEnabled$1(canvas) {\n  try {\n    if (!window.WebGLRenderingContext) { return false; }\n    if (!canvas) { canvas = document.createElement('canvas'); }\n    return !!(canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));\n  } catch (e) {\n    return false;\n  }\n}\n\nexport { makeScene$1 as scene, PointCollection, Point, LineCollection, WireCollection, LineStripCollection, Element, isWebGLEnabled$1 as isWebGLEnabled, glUtils as utils };\n//# sourceMappingURL=wgl.module.js.map\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../w-gl/build/wgl.module.js\n// module id = TzaH\n// module chunks = 1","/*\n * JavaScript Canvas to Blob\n * https://github.com/blueimp/JavaScript-Canvas-to-Blob\n *\n * Copyright 2012, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on stackoverflow user Stoive's code snippet:\n * http://stackoverflow.com/q/4998908\n */\n\n/* global define, Uint8Array, ArrayBuffer, module */\n\n;(function(window) {\n  'use strict'\n\n  var CanvasPrototype =\n    window.HTMLCanvasElement && window.HTMLCanvasElement.prototype\n  var hasBlobConstructor =\n    window.Blob &&\n    (function() {\n      try {\n        return Boolean(new Blob())\n      } catch (e) {\n        return false\n      }\n    })()\n  var hasArrayBufferViewSupport =\n    hasBlobConstructor &&\n    window.Uint8Array &&\n    (function() {\n      try {\n        return new Blob([new Uint8Array(100)]).size === 100\n      } catch (e) {\n        return false\n      }\n    })()\n  var BlobBuilder =\n    window.BlobBuilder ||\n    window.WebKitBlobBuilder ||\n    window.MozBlobBuilder ||\n    window.MSBlobBuilder\n  var dataURIPattern = /^data:((.*?)(;charset=.*?)?)(;base64)?,/\n  var dataURLtoBlob =\n    (hasBlobConstructor || BlobBuilder) &&\n    window.atob &&\n    window.ArrayBuffer &&\n    window.Uint8Array &&\n    function(dataURI) {\n      var matches,\n        mediaType,\n        isBase64,\n        dataString,\n        byteString,\n        arrayBuffer,\n        intArray,\n        i,\n        bb\n      // Parse the dataURI components as per RFC 2397\n      matches = dataURI.match(dataURIPattern)\n      if (!matches) {\n        throw new Error('invalid data URI')\n      }\n      // Default to text/plain;charset=US-ASCII\n      mediaType = matches[2]\n        ? matches[1]\n        : 'text/plain' + (matches[3] || ';charset=US-ASCII')\n      isBase64 = !!matches[4]\n      dataString = dataURI.slice(matches[0].length)\n      if (isBase64) {\n        // Convert base64 to raw binary data held in a string:\n        byteString = atob(dataString)\n      } else {\n        // Convert base64/URLEncoded data component to raw binary:\n        byteString = decodeURIComponent(dataString)\n      }\n      // Write the bytes of the string to an ArrayBuffer:\n      arrayBuffer = new ArrayBuffer(byteString.length)\n      intArray = new Uint8Array(arrayBuffer)\n      for (i = 0; i < byteString.length; i += 1) {\n        intArray[i] = byteString.charCodeAt(i)\n      }\n      // Write the ArrayBuffer (or ArrayBufferView) to a blob:\n      if (hasBlobConstructor) {\n        return new Blob([hasArrayBufferViewSupport ? intArray : arrayBuffer], {\n          type: mediaType\n        })\n      }\n      bb = new BlobBuilder()\n      bb.append(arrayBuffer)\n      return bb.getBlob(mediaType)\n    }\n  if (window.HTMLCanvasElement && !CanvasPrototype.toBlob) {\n    if (CanvasPrototype.mozGetAsFile) {\n      CanvasPrototype.toBlob = function(callback, type, quality) {\n        var self = this\n        setTimeout(function() {\n          if (quality && CanvasPrototype.toDataURL && dataURLtoBlob) {\n            callback(dataURLtoBlob(self.toDataURL(type, quality)))\n          } else {\n            callback(self.mozGetAsFile('blob', type))\n          }\n        })\n      }\n    } else if (CanvasPrototype.toDataURL && dataURLtoBlob) {\n      CanvasPrototype.toBlob = function(callback, type, quality) {\n        var self = this\n        setTimeout(function() {\n          callback(dataURLtoBlob(self.toDataURL(type, quality)))\n        })\n      }\n    }\n  }\n  if (typeof define === 'function' && define.amd) {\n    define(function() {\n      return dataURLtoBlob\n    })\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = dataURLtoBlob\n  } else {\n    window.dataURLtoBlob = dataURLtoBlob\n  }\n})(window)\n\n\n// WEBPACK FOOTER //\n// ./src/lib/canvas2BlobPolyfill.js","let tinycolor = require('tinycolor2');\nlet place = require('../proto/place.js').place;\n\nmodule.exports = function svgExport(layers, rect, style) {\n  let ways = [];\n  let date = (new Date()).toISOString();\n  let strokeWidth = 1/window.devicePixelRatio;\n  let svgDoc = [\n`<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!-- Generator: https://github.com/anvaka/city-roads\nData © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright\n-->\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n   viewBox=\"${rect.left} ${rect.top} ${rect.width} ${rect.height}\">\n   <style>\n   path {\n    vector-effect: non-scaling-stroke;\n   }\n   </style>\n   <rect id=\"background\" fill=\"${style.background}\" x=\"${rect.left}\" y=\"${rect.top}\" width=\"${rect.width}\" height=\"${rect.height}\"></rect>\n`\n  ]\n  layers.forEach(layer => addPaths(layer));\n  addText();\n\n  svgDoc.push(`</svg>`)\n\n  return svgDoc.join('\\n');\n\n  function addPaths(gridLayer) {\n    let grid = gridLayer.grid;\n    if (!grid) return;\n\n    let lineColor = tinycolor(gridLayer.color).toHexString();\n    svgDoc.push(`<g id=\"${gridLayer.id}\" fill=\"none\" stroke=\"${lineColor}\" stroke-width=\"${strokeWidth}\">`)\n    let positions = grid.nodes;\n    let project = grid.getProjector();\n    grid.forEachElement(x => {\n      if (x.type !== 'way') {\n        return;\n      }\n      let prev = null;\n      let hasLine = false;\n      let points = x.nodes.map(node => {\n        let pt = project(positions.get(node));\n        if (isOutside(pt, rect)) {\n          prev = null;\n          return;\n        }\n  \n        let prefix = prev === null ? 'M' : 'L'\n        let shouldAddPrefix = (prefix !== prev);\n        if (prefix === 'L') hasLine = true;\n        prev = prefix;\n  \n        return `${shouldAddPrefix ? prefix : ''}${pt.x},${pt.y}`;\n      }).filter(x => x).join(' ')\n  \n      if (hasLine) {\n        svgDoc.push(`<path d=\"${points}\" />`);\n      }\n    });\n    svgDoc.push(`</g>`)\n  }\n\n  function addText() {\n    let scaleX = window.innerWidth / rect.width;\n    let scaleY = window.innerHeight / rect.height;\n    style.labels.map(label => {\n      if (!label.text) return;\n      let insecurelyEscaped = label.text\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n      \n      // Note: this is not 100% accurate, might need to be fixed eventually\n      let bounds = label.bounds;\n      let leftOffset = rect.width * bounds.right / window.innerWidth + rect.left;\n      let bottomOffset = rect.height * bounds.bottom / window.innerHeight + rect.top;\n      let upScale = rect.height * label.fontSize / window.innerHeight;\n\n      let fontFamily = label.fontFamily.replace(/\"/g, '\\'');\n      return `<text text-anchor=\"end\" x=\"${leftOffset}\" y=\"${bottomOffset}\" fill=\"${label.color}\" font-family=\"${fontFamily}\" font-size=\"${upScale}\">${insecurelyEscaped}</text>`\n    }).forEach(item => {\n      if (!item) return;\n      svgDoc.push(item);\n    })\n  }\n}\n\nfunction isOutside(point, rect) {\n  return point.x < rect.left || point.x > rect.right ||\n         point.y < rect.top || point.y > rect.bottom;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/svgExport.js"],"sourceRoot":""}